<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>confd_lib_maapi</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="ConfD User Guide"><link rel="up" href="rn02.html" title="ConfD man-pages, Volume 3"><link rel="prev" href="rn02re13.html" title="confd_lib_lib"><link rel="next" href="rn02re15.html" title="confd_types"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">confd_lib_maapi</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="rn02re13.html">Prev</a>&nbsp;</td><th width="60%" align="center">ConfD man-pages, Volume 3</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="rn02re15.html">Next</a></td></tr></table><hr></div><div class="refentry"><a name="man.3.confd_lib_maapi"></a><div class="titlepage"></div><div class="refnamediv"><a name="man.3.confd_lib_maapi.name"></a><h2>Name</h2><p>confd_lib_maapi &#8212; MAAPI (Management Agent API). A library for connecting
    to <span class="phrase">ConfD</span>
     with a read/write interface inside
    transactions.</p></div><div class="refsynopsisdiv"><a name="man.3.confd_lib_maapi.synopsis"></a><h2>Synopsis</h2><div class="funcsynopsis"><pre class="funcsynopsisinfo">#include &lt;confd_lib.h&gt;
#include &lt;confd_maapi.h&gt;
      </pre><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">username</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">groups</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">numgroups</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_user_session2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">username</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">groups</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">numgroups</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">dbname</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">dbname</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans_flags</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">dbname</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_connect</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const struct sockaddr* <var class="pdparam">srv</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">srv_sz</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_schemas</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_schemas_list</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const u_int32_t *<var class="pdparam">nshash</var>, </td></tr><tr><td>&nbsp;</td><td>const int *<var class="pdparam">nsflags</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_ns</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_schema_file_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">buf</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_close</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_user_session3</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">username</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">groups</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">numgroups</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">vendor</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">product</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">version</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">client_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_end_user_session</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_kill_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_sessions</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">res[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_user_info *<var class="pdparam">us</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_my_user_session_id</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_session_identification</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_user_identification *<var class="pdparam">uident</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_session_opaque</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">opaque</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_authorization_info</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_authorization_info **<var class="pdparam">ainfo</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_next_user_session_id</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_lock</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_unlock</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_is_lock_set</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_lock_partial</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">xpaths[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nxpaths</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">lockid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_unlock_partial</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">lockid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_validate</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_delete_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_commit</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_commit_persistent</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_commit_info</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">label</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">comment</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_confirmed_commit</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_confirmed_commit_persistent</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_confirmed_commit_info</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">label</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">comment</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_abort_commit</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_abort_commit_persistent</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_reset</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_confirmed_commit_in_progress</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy_running_to_startup</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_is_running_modified</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_is_candidate_modified</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans_flags2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">dbname</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">vendor</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">product</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">version</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">client_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans_in_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_finish_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_validate_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">unlock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">forcevalidation</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_prepare_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_prepare_trans_flags</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_commit_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_abort_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_apply_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">keepopen</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_apply_trans_flags</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">keepopen</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_apply_trans_with_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">keepopen</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">tag</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nvalues</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_commit_queue_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>struct ncs_commit_queue_result *<var class="pdparam">result</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_namespace</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_pushd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_popd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_getcwd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>size_t <var class="pdparam">strsz</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">curdir</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_getcwd_kpath</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_hkeypath_t **<var class="pdparam">kp</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_exists</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_num_instances</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int8_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int8_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int16_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int16_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int32_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int64_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int8_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int8_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int16_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int16_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int32_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int64_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv4_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct in_addr *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv6_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct in6_addr *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_double_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>double *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bool_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_datetime_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_datetime *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_date_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_date *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_time_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_time *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_duration_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_duration *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_enum_value_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bit32_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bit64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int64_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bitbig_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">bufsiz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_objectref_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_hkeypath_t **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_oid_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_snmp_oid **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_buf_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">bufsiz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_str_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_binary_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">bufsiz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_hexstr_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">bufsiz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_qname_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">prefix</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">prefixsz</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">namesz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_list_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv4prefix_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_ipv4_prefix *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv6prefix_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_ipv6_prefix *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_decimal64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_decimal64 *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_identityref_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_identityref *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv4_and_plen_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_ipv4_prefix *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv6_and_plen_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_ipv6_prefix *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_dquad_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_dotted_quad *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_vget_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>va_list <var class="pdparam">args</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_init_cursor</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct maapi_cursor *<var class="pdparam">mc</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_next</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_find_next</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_find_next_type <var class="pdparam">type</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">inkeys</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n_inkeys</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void <b class="fsfunc">maapi_destroy_cursor</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_elem2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">strval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_vset_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>va_list <var class="pdparam">args</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_create</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_delete</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_object</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_objects</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nobj</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_values</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_object</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const confd_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_values</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const confd_tag_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_case</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">choice</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">rcase</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_attrs</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t *<var class="pdparam">attrs</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_attrs</var>, </td></tr><tr><td>&nbsp;</td><td>confd_attr_value_t **<var class="pdparam">attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">num_vals</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_attr</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t <var class="pdparam">attr</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_delete_all</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_delete_how <var class="pdparam">how</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_revert</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_flags</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_delayed_when</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">on</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_label</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">label</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_comment</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">comment</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">from_thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">to_thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">from_thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">to_thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy_tree</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">from</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">tofmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_insert</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_move</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t* <var class="pdparam">tokey</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_move_ordered</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_move_where <var class="pdparam">where</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t* <var class="pdparam">tokey</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_create</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_set_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_set_elem2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">strval</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_set_values</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const confd_tag_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_insert</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_copy_tree</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">from</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">tofmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_ncs_apply_template</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">template_name</var>, </td></tr><tr><td>&nbsp;</td><td>const struct ncs_name_value *<var class="pdparam">variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">rootfmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_ncs_apply_template</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">template_name</var>, </td></tr><tr><td>&nbsp;</td><td>const struct ncs_name_value *<var class="pdparam">variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">rootfmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_ncs_get_templates</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>char ***<var class="pdparam">templates</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">num_templates</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_ncs_write_service_log_entry</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">msg</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">type</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">level</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_authenticate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">user</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">pass</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">groups[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_authenticate2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">user</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">pass</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">groups[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_validate_token</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">token</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">groups[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_attach</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_trans_ctx *<var class="pdparam">ctx</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_attach2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_attach_init</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_detach</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_trans_ctx *<var class="pdparam">ctx</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_detach2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_diff_iterate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_op <var class="pdparam">op</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">oldv</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">newv</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_keypath_diff_iterate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_op <var class="pdparam">op</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">oldv</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">newv</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_diff_iterate_resume</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret <var class="pdparam">reply</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_op <var class="pdparam">op</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">oldv</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">newv</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">resumestate</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_iterate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>confd_attr_value_t *<var class="pdparam">attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_iterate_resume</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret <var class="pdparam">reply</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>confd_attr_value_t *<var class="pdparam">attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">resumestate</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_running_db_status</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_running_db_status</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">status</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_list_rollbacks</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>struct maapi_rollback *<var class="pdparam">rp</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">rp_size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_rollback</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">rollback_num</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_request_action</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t *<var class="pdparam">params</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nparams</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nvalues</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_request_action_th</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t *<var class="pdparam">params</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nparams</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nvalues</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_request_action_str_th</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">output</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">cmd_fmt</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">path_fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_xpath2kpath</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">xpath</var>, </td></tr><tr><td>&nbsp;</td><td>confd_hkeypath_t **<var class="pdparam">hkp</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_user_message</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">to</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">message</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">sender</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_sys_message</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">to</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_prio_message</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">to</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_diff_cmd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle_old</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_accounting</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">user</var>, </td></tr><tr><td>&nbsp;</td><td>const int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">cmdstr</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_path_cmd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_to_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">line</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">ns</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsize</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">path</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">psize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_to_path2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">line</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">ns</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsize</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">path</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">psize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeout</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt_oneof</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">choice</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">count</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt_oneof2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">choice</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">count</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeout</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_read_eof</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_read_eof2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeout</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_write</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd3</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd4</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_io</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_io2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_io_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_printf</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_vprintf</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>va_list <var class="pdparam">args</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_set</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">opt</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">value</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_get</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">opt</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_readonly_mode</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flag</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_disconnect_remote</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">address</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_disconnect_sockets</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">sockets</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsocks</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_save_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_save_config_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">filename</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config_cmds</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">cmds</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config_stream</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config_stream_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_roll_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_roll_config_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_stream_progress</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_xpath_eval</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>int (*<var class="pdparam">result</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>void (*<var class="pdparam">trace</var>)(char *), </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_xpath_eval_expr</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>void (*<var class="pdparam">trace</var>)(char *), </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_start</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context_node</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">chunk_size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">initial_offset</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_query_result_type <var class="pdparam">result_as</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nselect</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">select[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsort</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">sort[]</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_startv</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context_node</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">chunk_size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">initial_offset</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_query_result_type <var class="pdparam">result_as</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">select_nparams</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_query_result **<var class="pdparam">qrs</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_result_count</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_free_result</b>(</code></td><td>struct confd_query_result *<var class="pdparam">qrs</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_reset_to</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">offset</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_reset</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_stop</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_do_display</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_install_crypto_keys</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_init_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_perform_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">loadpathdirs</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_commit_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_abort_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_aaa_reload</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_aaa_reload_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_snmpa_reload</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_phase</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">phase</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_wait_start</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">phase</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_reload_config</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_reopen_logs</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_stop</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_rebind_listener</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">listener</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_clear_opcache</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div></div><div class="refsect1"><a name="man.3.confd_lib_maapi.library"></a><h2>LIBRARY</h2><p><span class="phrase">ConfD</span>
     Library,
    (<code class="filename">libconfd</code>, <code class="option">-lconfd</code>)</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.description"></a><h2>DESCRIPTION</h2><p>The <code class="filename">libconfd</code> shared library is used to
    connect to the ConfD transaction manager. The API
    described in this man page has several purposes. We can use MAAPI
    when we wish to implement our own proprietary management agent.
    We also use MAAPI to attach to already existing ConfD
    transactions, for example when we wish to implement semantic
    validation of configuration data in C, and also when we wish to
    implement CLI wizards in C.</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.paths"></a><h2>PATHS</h2><p>The majority of the functions described here take as their
    two last arguments a format string and a variable number of extra
    arguments as in: <span class="type">char *</span> <em class="parameter"><code>fmt</code></em>,
    <em class="parameter"><code>...</code></em><code class="code">);</code></p><p>The paths for MAAPI work like paths for CDB (see
    <a class="link" href="rn02re09.html#man.3.confd_lib_cdb.paths" title="PATHS">confd_lib_cdb(3)</a>)
    with the exception that the
    bracket notation '[n]' is not allowed for MAAPI paths.</p><p>All the functions that take a path on this form also have a
    <span class="type">va_list</span> variant, of the same form as
    <code class="function">maapi_vget_elem()</code> and
    <code class="function">maapi_vset_elem()</code>, which are the only ones
    explicitly documented below. I.e. they have a prefix "maapi_v"
    instead of "maapi_", and take a single va_list argument instead of a
    variable number of arguments.</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.functions"></a><h2>FUNCTIONS</h2><p>All functions return CONFD_OK (0), CONFD_ERR (-1) or
    CONFD_EOF (-2) unless otherwise stated.  Whenever CONFD_ERR is
    returned from any API function in confd_lib_maapi it is possible
    to obtain additional information on the error through the symbol
    <code class="varname">confd_errno</code>, see the ERRORS section of
    <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>.</p><p>In the case of CONFD_EOF it means that the socket to
    <span class="phrase">ConfD</span>
     has been closed.</p><div class="funcsynopsis"><a name="fn.maapi_connect"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_connect</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const struct sockaddr* <var class="pdparam">srv</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">srv_sz</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>The application has to connect to
   <span class="phrase">ConfD</span>
    before it can
   interact with <span class="phrase">ConfD</span>
   .</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If this call fails (i.e. does not return CONFD_OK), the
   socket descriptor must be closed and a new socket created before
   the call is re-attempted.</p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_load_schemas"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_schemas</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function dynamically loads schema information from the
   ConfD daemon into the library, where it is available to all the
   library components as described in the
   <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a> and
   <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a> man pages.  See also
   <code class="function">confd_load_schemas()</code> in
   <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_load_schemas_list"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_schemas_list</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const u_int32_t *<var class="pdparam">nshash</var>, </td></tr><tr><td>&nbsp;</td><td>const int *<var class="pdparam">nsflags</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_ns</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>A variant of <code class="function">maapi_load_schemas()</code> that
   allows for loading a subset of the schema information from the ConfD
   daemon into the library. This means that the loading can be
   significantly faster in the case of a system with many large data
   models, with the drawback that the functions that use the schema
   information will have limited functionality or not work at all.</p><p>The <em class="parameter"><code>flags</code></em> parameter can be given as
   <code class="constant">CONFD_LOAD_SCHEMA_HASH</code> to request that the
   global mapping between strings and hash values for the data model
   nodes should be loaded. If <em class="parameter"><code>flags</code></em> is given as
   0, this mapping is not loaded. The mapping is required for use of the
   functions <code class="function">confd_hash2str()</code>,
   <code class="function">confd_str2hash()</code>,
   <code class="function">confd_cs_node_cd()</code>, and
   <code class="function">confd_xpath_pp_kpath()</code>. Additionally, without the
   mapping, <code class="function">confd_pp_value()</code>,
   <code class="function">confd_pp_kpath()</code>, and
   <code class="function">confd_pp_kpath_len()</code>, as well as the trace
   printouts from the library, will print nodes as "tag&lt;N&gt;", where
   N is the hash value, instead of the node name.</p><p>The <em class="parameter"><code>nshash</code></em> parameter is a
   <em class="parameter"><code>num_ns</code></em> elements long array of namespace hash
   values, requesting that schema information should be loaded for the
   listed namespaces according to the corresponding element of the
   <em class="parameter"><code>nsflags</code></em> array (also
   <em class="parameter"><code>num_ns</code></em> elements long). For each namespace,
   either or both of these flags may be given:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">CONFD_LOAD_SCHEMA_NODES</code></span></dt><dd><p>This flag requests that the <span class="type">confd_cs_node</span>
         tree (see <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a>) for the
         namespace should be loaded. This tree is required for the use
         of the functions <code class="function">confd_find_cs_root()</code>,
         <code class="function">confd_find_cs_node()</code>,
         <code class="function">confd_find_cs_node_child()</code>,
         <code class="function">confd_cs_node_cd()</code>,
         <code class="function">confd_register_node_type()</code>,
         <code class="function">confd_get_leaf_list_type()</code>, and
         <code class="function">confd_xpath_pp_kpath()</code> for the
         namespace. Additionally, the above functions that print a
         <span class="type">confd_hkeypath_t</span>, as well as the library trace
         printouts, will attempt to use this tree and the type
         information (see below) to find the correct string
         representation for key values - if the tree isn't available,
         key values will be printed as described for
         <code class="function">confd_pp_value()</code>.</p></dd><dt><span class="term"><code class="constant">CONFD_LOAD_SCHEMA_TYPES</code></span></dt><dd><p>This flag requests that information about the types
         defined in the namespace should be loaded. The type information
         is required for use of the functions
         <code class="function">confd_val2str()</code>,
         <code class="function">confd_str2val()</code>,
         <code class="function">confd_find_ns_type()</code>,
         <code class="function">confd_get_leaf_list_type()</code>,
         <code class="function">confd_register_ns_type()</code>, and
         <code class="function">confd_register_node_type()</code> for the
         namespace. Additionally the
         <span class="type">confd_hkeypath_t</span>-printing functions and the
         library trace printouts will also fall back to
         <code class="function">confd_pp_value()</code> as described above if the
         type information isn't available.</p><p>Type definitions may refer to types defined in other
         namespaces. If the <code class="constant">CONFD_LOAD_SCHEMA_TYPES</code>
         flag has been given for a namespace, and the types defined
         there have such type references to namespaces that are not
         included in the <em class="parameter"><code>nshash</code></em> array, the
         referenced type information will also be loaded, if necessary
         recursively, until the types have a complete definition.</p></dd></dl></div><p>See also <code class="function">confd_load_schemas_list()</code> in
   <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_get_schema_file_path"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_schema_file_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">buf</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If shared memory schema support has been enabled via <span class="phrase"><code class="sgmltag-element">/confdConfig/enableSharedMemorySchema</code> in
   <code class="filename">confd.conf</code></span>, this function will return the
   pathname of the file used for the shared memory mapping, which can
   then be passed to <code class="function">confd_mmap_schemas()</code> (see
   <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>).  If
   the call is successful, <em class="parameter"><code>buf</code></em> is set to point to
   a dynamically allocated string, which must be freed by the
   application by means of calling <code class="function">free(3)</code>.</p><p>If creation of the schema file is in progress when the function
   is called, the call will block until the creation has completed. If
   shared memory schema support has not been enabled, or if the creation
   of the schema file failed, the function returns CONFD_ERR with
   <code class="varname">confd_errno</code> set to CONFD_ERR_NOEXISTS.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_close"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_close</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Effectively a call to
   <code class="function">maapi_end_user_session()</code> and also closes the
   socket.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION</p><p>Even if the call returns an error, the socket will be closed.</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.session_management"></a><h2>SESSION MANAGEMENT</h2><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">username</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">groups</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">numgroups</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Once we have created a MAAPI socket, we must also establish
    a user session on the socket. It is up to the user of the MAAPI
    library to authenticate users. The library user can ask
    <span class="phrase">ConfD</span>
     to
    perform the actual authentication through a call to
    <code class="function">maapi_authenticate()</code> but authentication may
    very well occur through some other external means.</p><p>Thus, when we use this function to create a user session, we
    must provide all relevant information about the user. If we wish
    to execute read/write transactions over the MAAPI interface, we
    must first have an established user session.</p><p>A user session corresponds to a NETCONF manager who has just
    established an authenticated SSH connection, but not yet sent any
    NETCONF commands on the SSH connection.</p><p>The <span class="type">struct confd_ip</span> is defined in
    <code class="filename">confd_lib.h</code> and must be properly populated before
    the call. For example:</p><div class="informalexample"><pre class="programlisting">struct confd_ip ip;
ip.af = AF_INET;
inet_aton("10.0.0.33", &amp;ip.ip.v4);</pre></div><p>The <em class="parameter"><code>context</code></em> parameter can be any
    string. The string provided here is precisely the context string
    which will be used to authorize all data access through the AAA
    system. Each AAA rule has a context string which must match in
    order for a AAA rule to match. (See the AAA chapter in the User
    Guide.)</p><p>Using the string "system" for <em class="parameter"><code>context</code></em>
    has special significance:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The session is exempt from all
        <code class="sgmltag-element">maxSessions</code> limits in confd.conf.</p></li><li class="listitem"><p>There will be no authorization checks done by the AAA
        system.</p></li><li class="listitem"><p>The session is not logged in the audit log.</p></li><li class="listitem"><p>The session is not shown in 'show users' in CLI etc.</p></li><li class="listitem"><p>The session may be started already in
        <span class="phrase">ConfD</span>
         start phase 0.
        (However read-write transactions can not be started until phase
        1, i.e. transactions started in phase 0 must use parameter
        <em class="parameter"><code>readwrite</code></em> ==
        <code class="constant">CONFD_READ</code>).</p></li></ul></div><p>Thus this can be useful e.g. when we need to create the user
    session for an "internal" transaction done by an application,
    without relation to a session from a northbound agent. Of course
    the implications of the above need to be carefully considered in
    each case.</p><p>It is not possible to create new user sessions until
    ConfD
    has reached start phase 2 (See <a class="link" href="rn01re01.html" title="confd">confd(1)</a>), with
    the above exception of a session with the context set to "system".</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_ALREADY_EXISTS, CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_user_session2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">username</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">groups</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">numgroups</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
    <code class="function">maapi_start_user_session()</code>, but allows for the
    TCP/UDP source port to be passed to <span class="phrase">ConfD</span>
    . Calling
    <code class="function">maapi_start_user_session()</code> is equivalent to
    calling <code class="function">maapi_start_user_session2()</code> with
    <em class="parameter"><code>src_port</code></em> 0.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_ALREADY_EXISTS, CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><a name="fn.maapi_start_user_session3"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_user_session3</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">username</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">groups</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">numgroups</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">vendor</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">product</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">version</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">client_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
    <code class="function">maapi_start_user_session2()</code>, but allows additional
    information about the session to be passed to <span class="phrase">ConfD</span>
    . Calling
    <code class="function">maapi_start_user_session2()</code> is equivalent to
    calling <code class="function">maapi_start_user_session3()</code> with
    <em class="parameter"><code>vendor</code></em>, <em class="parameter"><code>product</code></em> and
    <em class="parameter"><code>version</code></em> set to NULL, and <em class="parameter"><code>client_id</code></em>
    set to __MAAPI_CLIENT_ID__. The __MAAPI_CLIENT_ID__ macro (defined in confd_maapi.h)
    will expand to a string representation of __FILE__:__LINE__.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_ALREADY_EXISTS, CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><a name="fn.maapi_end_user_session"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_end_user_session</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Ends our own user session. If the MAAPI socket is closed,
    the user session is automatically ended.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION</p><div class="funcsynopsis"><a name="fn.maapi_kill_user_session"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_kill_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Kill the user session identified by
    <em class="parameter"><code>usessid</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_get_user_sessions"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_sessions</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">res[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Get the usessid for all current user sessions. The
    <em class="parameter"><code>res</code></em> array is populated with at most
    <em class="parameter"><code>n</code></em> usessids, and the total number of user
    sessions is returned (i.e. if the return value is larger than
    <em class="parameter"><code>n</code></em>, the array was too short to hold all
    usessids).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_get_user_session"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_user_info *<var class="pdparam">us</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Populate the <span class="type">confd_user_info</span> structure
    with the data for the user session identified by
    <em class="parameter"><code>usessid</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_get_my_user_session_id"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_my_user_session_id</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>A user session is identified through an integer index, a
    usessid.  This function returns the usessid associated with the
    MAAPI socket <em class="parameter"><code>sock</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_user_session"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_user_session</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Associate the socket with an already existing user session.
    This can be used instead of
    <code class="function">maapi_start_user_session()</code> when we really do
    not want to start a new user session, e.g. if we want to call an
    action on behalf of a given user session.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_get_user_session_identification"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_session_identification</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_user_identification *<var class="pdparam">uident</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If the flag <code class="constant">CONFD_USESS_FLAG_HAS_IDENTIFICATION</code>
    is set in the <code class="varname">flags</code> field of the
    <span class="type">confd_user_info</span> structure, additional identification
    information has been provided by the northbound client. This
    information can then be retrieved into a
    <span class="type">confd_user_identification</span> structure (see
    <code class="filename">confd_lib.h</code>) by calling this function. The
    elements of <span class="type">confd_user_identification</span> are either NULL (if the
    corresponding information was not provided) or point to a string.
    The strings must be freed by the application by means of calling
    <code class="function">free(3)</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_get_user_session_opaque"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_user_session_opaque</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">opaque</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If the flag <code class="constant">CONFD_USESS_FLAG_HAS_OPAQUE</code>
    is set in the <code class="varname">flags</code> field of the
    <span class="type">confd_user_info</span> structure, "opaque" information has
    been provided by the northbound client (see the <code class="option">-O</code>
    option in <a class="link" href="rn01re03.html" title="confd_cli">confd_cli(1)</a>). The information
    can then be retrieved by calling this function. If the call is
    successful, <em class="parameter"><code>opaque</code></em> is set to point to a
    dynamically allocated string, which must be freed by the application
    by means of calling <code class="function">free(3)</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_get_authorization_info"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_authorization_info</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_authorization_info **<var class="pdparam">ainfo</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function retrieves authorization info for a user session,
    i.e. the groups that the user has been assigned to. The <span class="type">struct
    confd_authorization_info</span> is defined as:</p><div class="informalexample"><a name="struct.confd_authorization_info"></a><pre class="programlisting"><strong class="hl-keyword">struct</strong> confd_authorization_info {
    <strong class="hl-keyword">int</strong> ngroups;
    <strong class="hl-keyword">char</strong> **groups;
};</pre></div><p>If the call is successful, <em class="parameter"><code>ainfo</code></em> is set
    to point to a dynamically allocated structure, which must be freed
    by the application by means of calling
    <code class="function">confd_free_authorization_info()</code> (see <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>) .</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_next_user_session_id"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_next_user_session_id</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usessid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set the user session id that will be assigned to the next user
    session started. The given value is silently forced to be in the
    range 100 .. 2^31-1. This function can be used to ensure that
    session ids for user sessions started by northbound agents or via
    MAAPI are unique across a <span class="phrase">ConfD</span>
     restart.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.locks"></a><h2>LOCKS</h2><div class="funcsynopsis"><a name="fn.maapi_lock"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_lock</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><div class="funcsynopsis"><a name="fn.maapi_unlock"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_unlock</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>These functions can be used to manipulate locks on the 3
   different database types.  If <code class="function">maapi_lock()</code> is
   called and the database is already locked, CONFD_ERR is returned,
   and <code class="varname">confd_errno</code> will be set to
   CONFD_ERR_LOCKED. If <code class="varname">confd_errno</code> is
   CONFD_ERR_EXTERNAL it means that a callback has been invoked in an
   external database to lock/unlock which in its turn returned an
   error.  (See <a class="link" href="rn02re10.html" title="confd_lib_dp">confd_lib_dp(3)</a> for external
   database callback API)</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_LOCKED, CONFD_ERR_EXTERNAL, CONFD_ERR_NOSESSION</p><div class="funcsynopsis"><a name="fn.maapi_is_lock_set"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_is_lock_set</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Returns a positive integer being the usid of the current lock
   owner if the lock is set, and 0 if the lock is not set.</p><div class="funcsynopsis"><a name="fn.maapi_lock_partial"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_lock_partial</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">xpaths[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nxpaths</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">lockid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><div class="funcsynopsis"><a name="fn.maapi_unlock_partial"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_unlock_partial</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">lockid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We can also manipulate partial locks on the databases,
   i.e. locks on a specified set of leafs and/or subtrees. The
   specification of what to lock is given via the
   <em class="parameter"><code>xpaths</code></em> array, which is populated with
   <em class="parameter"><code>nxpaths</code></em> pointers to XPath expressions.  If the
   lock succeeds, <code class="function">maapi_lock_partial()</code> returns
   CONFD_OK, and a lock identifier to use with
   <code class="function">maapi_unlock_partial()</code> is stored in
   <em class="parameter"><code>*lockid</code></em>.</p><p>If CONFD_ERR is returned, some values of
   <code class="varname">confd_errno</code> are of particular interest:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">CONFD_ERR_LOCKED</span></dt><dd><p>Some of the requested nodes are already locked.</p></dd><dt><span class="term">CONFD_ERR_EXTERNAL</span></dt><dd><p>A callback has been invoked in an external database to
         lock_partial/unlock_partial which in its turn returned an
         error (see <a class="link" href="rn02re10.html" title="confd_lib_dp">confd_lib_dp(3)</a> for
         external database callback API).</p></dd><dt><span class="term">CONFD_ERR_NOEXISTS</span></dt><dd><p>The list of XPath expressions evaluated to an empty set
         of nodes - i.e. there is nothing to lock.</p></dd></dl></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_LOCKED, CONFD_ERR_EXTERNAL, CONFD_ERR_NOSESSION,
   CONFD_ERR_NOEXISTS</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.candidate_manipulation"></a><h2>CANDIDATE MANIPULATION</h2><p>All the candidate manipulation functions require that the
    candidate data store is enabled in <code class="filename">confd.conf</code> -
    otherwise they will set <code class="varname">confd_errno</code> to
    CONFD_ERR_NOEXISTS. If the candidate data store is enabled,
    <code class="varname">confd_errno</code> may be set to CONFD_ERR_NOEXISTS for
    other reasons, as described below.</p><p>All these functions may also set
    <code class="varname">confd_errno</code> to CONFD_ERR_EXTERNAL. This value can
    only be set when the candidate is owned by the external
    database. When <span class="phrase">ConfD</span>
     owns the candidate, which is
    the most common
    configuration scenario, the candidate manipulation function will
    never set <code class="varname">confd_errno</code> to
    CONFD_ERR_EXTERNAL.</p><div class="funcsynopsis"><a name="fn.maapi_candidate_validate"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_validate</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function validates the candidate. The function should
    only be used when the candidate is not owned by
    <span class="phrase">ConfD</span>
    , i.e. when
    the candidate is owned by an external database.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_commit"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_commit</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function copies the candidate to running. It is also
    used to confirm a previous call to
    <code class="function">maapi_candidate_confirmed_commit()</code>, i.e. to
    prevent the automatic rollback if a confirmed commit is not
    confirmed.</p><p>If <code class="varname">confd_errno</code> is CONFD_ERR_INUSE it means
    that some other user session is doing a confirmed commit or has a
    lock on the database. CONFD_ERR_NOEXISTS means that there is an
    ongoing persistent confirmed commit (see below) - i.e. there is no
    confirmed commit that this function call can apply to.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_confirmed_commit"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_confirmed_commit</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function also copies the candidate into running. However
    if a call to <code class="function">maapi_candidate_commit()</code> is not
    done within <em class="parameter"><code>timeoutsecs</code></em> an automatic rollback
    will occur. It can also be used to "extend" a confirmed commit that
    is already in progress, i.e. set a new timeout or add changes.</p><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that there is an ongoing persistent confirmed commit (see
    below).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_abort_commit"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_abort_commit</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function cancels an ongoing confirmed commit.</p><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that some other user session initiated the confirmed commit,
    or that there is an ongoing persistent confirmed commit (see
    below).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_NOSESSION, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_confirmed_commit_persistent"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_confirmed_commit_persistent</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function can be used to start or extend a persistent
    confirmed commit. The <em class="parameter"><code>persist</code></em> parameter sets the
    cookie for the persistent confirmed commit, while the
    <em class="parameter"><code>persist_id</code></em> gives the cookie for an already
    ongoing persistent confirmed commit. This gives the following
    possibilities:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>persist</code></em> = "cookie",
        <em class="parameter"><code>persist_id</code></em> = NULL</span></dt><dd><p>Start a persistent confirmed commit with the cookie
          "cookie", or extend an already ongoing non-persistent
          confirmed commit and turn it into a persistent confirmed
          commit.</p></dd><dt><span class="term"><em class="parameter"><code>persist</code></em> = "newcookie",
        <em class="parameter"><code>persist_id</code></em> = "oldcookie"</span></dt><dd><p>Extend an ongoing persistent confirmed commit that uses
          the cookie "oldcookie" and change the cookie to
          "newcookie".</p></dd><dt><span class="term"><em class="parameter"><code>persist</code></em> = NULL,
        <em class="parameter"><code>persist_id</code></em> = "cookie"</span></dt><dd><p>Extend an ongoing persistent confirmed commit that uses
          the cookie "oldcookie" and turn it into a non-persistent
          confirmed commit.</p></dd><dt><span class="term"><em class="parameter"><code>persist</code></em> = NULL,
        <em class="parameter"><code>persist_id</code></em> = NULL</span></dt><dd><p>Does the same as
          <code class="function">maapi_candidate_confirmed_commit()</code>.</p></dd></dl></div><p>Typical usage is to start a persistent confirmed commit with
    <em class="parameter"><code>persist</code></em> = "cookie", <em class="parameter"><code>persist_id</code></em>
    = NULL, and to extend it with <em class="parameter"><code>persist</code></em> = "cookie",
    <em class="parameter"><code>persist_id</code></em> = "cookie".</p><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that there is an ongoing persistent confirmed commit, but
    <em class="parameter"><code>persist_id</code></em> didn't give the right cookie for
    it.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_confirmed_commit_info"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_confirmed_commit_info</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">label</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">comment</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
    <code class="function">maapi_candidate_confirmed_commit_persistent()</code>,
    but allows for setting the "Label" and/or "Comment" that is stored
    in the rollback file when the candidate is committed to running. To
    set only the "Label", give <em class="parameter"><code>comment</code></em> as NULL,
    and to set only the "Comment", give <em class="parameter"><code>label</code></em> as
    NULL. If both <em class="parameter"><code>label</code></em> and
    <em class="parameter"><code>comment</code></em> are NULL, the function does exactly
    the same as
    <code class="function">maapi_candidate_confirmed_commit_persistent()</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>To ensure that the "Label" and/or "Comment" are stored
    in the rollback file in all cases when doing a confirmed commit,
    they must be given both with the confirmed commit (using this
    function) and with the confirming commit (using
    <code class="function">maapi_candidate_commit_info()</code>).</p></div><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that there is an ongoing persistent confirmed commit, but
    <em class="parameter"><code>persist_id</code></em> didn't give the right cookie for
    it.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_commit_persistent"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_commit_persistent</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Confirm an ongoing persistent confirmed commit with the cookie
    given by <em class="parameter"><code>persist_id</code></em>. If
    <em class="parameter"><code>persist_id</code></em> is NULL, it does the same as
    <code class="function">maapi_candidate_commit()</code>.</p><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that there is an ongoing persistent confirmed commit, but
    <em class="parameter"><code>persist_id</code></em> didn't give the right cookie for
    it.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_commit_info"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_commit_info</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">label</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">comment</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
    <code class="function">maapi_candidate_commit_persistent()</code>, but allows
    for setting the "Label" and/or "Comment" that is stored in the
    rollback file when the candidate is committed to running. To set
    only the "Label", give <em class="parameter"><code>comment</code></em> as NULL, and
    to set only the "Comment", give <em class="parameter"><code>label</code></em> as
    NULL. If both <em class="parameter"><code>label</code></em> and
    <em class="parameter"><code>comment</code></em> are NULL, the function does exactly
    the same as
    <code class="function">maapi_candidate_commit_persistent()</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>To ensure that the "Label" and/or "Comment" are stored
    in the rollback file in all cases when doing a confirmed commit,
    they must be given both with the confirmed commit (using
    <code class="function">maapi_candidate_confirmed_commit_info()</code>) and
    with the confirming commit (using this function).</p></div><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that there is an ongoing persistent confirmed commit, but
    <em class="parameter"><code>persist_id</code></em> didn't give the right cookie for
    it.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_abort_commit_persistent"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_abort_commit_persistent</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">persist_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Cancel an ongoing persistent confirmed commit with the cookie
    given by <em class="parameter"><code>persist_id</code></em>. (If
    <em class="parameter"><code>persist_id</code></em> is NULL, it does the same as
    <code class="function">maapi_candidate_abort_commit()</code>.)</p><p>If <code class="varname">confd_errno</code> is CONFD_ERR_NOEXISTS it
    means that there is an ongoing persistent confirmed commit, but
    <em class="parameter"><code>persist_id</code></em> didn't give the right cookie for
    it.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOEXISTS, CONFD_ERR_INUSE, CONFD_ERR_NOSESSION,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_candidate_reset"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_candidate_reset</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function copies running into candidate.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_INUSE, CONFD_ERR_EXTERNAL, CONFD_ERR_NOSESSION</p><div class="funcsynopsis"><a name="fn.maapi_confirmed_commit_in_progress"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_confirmed_commit_in_progress</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Checks whether a confirmed commit is ongoing. Returns 1 if
    some user session currently has an ongoing confirmed commit
    operation and 0 if not.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_copy_running_to_startup"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy_running_to_startup</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function copies running to startup.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_INUSE, CONFD_ERR_EXTERNAL, CONFD_ERR_NOSESSION,
    CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_is_running_modified"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_is_running_modified</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Returns 1 if running has been modified since the last copy to
   startup, 0 if it has not been modified.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_is_candidate_modified"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_is_candidate_modified</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Returns 1 if candidate has been modified, i.e if there are any
   outstanding non committed changes to the candidate, 0 if no changes are done</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.transaction_control"></a><h2>TRANSACTION CONTROL</h2><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>The main purpose of MAAPI is to provide read and write
    access into the <span class="phrase">ConfD</span>
     transaction manager.
    Regardless of whether
    data is kept in CDB or in some (or several) external data bases,
    the same API is used to access data. ConfD acts as a mediator and
    multiplexes the different commands to the code which is
    responsible for each individual data node.</p><p>This function creates a new transaction towards the data store
    specified by <em class="parameter"><code>name</code></em>, which can be one of
    <code class="constant">CONFD_CANDIDATE</code>,
    <code class="constant">CONFD_OPERATIONAL</code>,
    <code class="constant">CONFD_RUNNING</code>, or
    <code class="constant">CONFD_STARTUP</code> (however updating the startup
    data store is better done via
    <code class="function">maapi_copy_running_to_startup()</code>). The
    <em class="parameter"><code>readwrite</code></em> parameter can be either
    <code class="constant">CONFD_READ</code>, to start a readonly transaction, or
    <code class="constant">CONFD_READ_WRITE</code>, to start a read-write
    transaction.</p><p>A readonly transaction will incur less resource usage,
    thus if no writes will be done (e.g. the purpose of the transaction
    is only to read operational data), it is best to use
    <code class="constant">CONFD_READ</code>. There are also some cases where
    starting a read-write transaction is not allowed, e.g. if we start a
    transaction towards the running data store and
    <code class="sgmltag-element">/confdConfig/datastores/running/access</code> is set to
    "writable-through-candidate" in <code class="filename">confd.conf</code>, or
    if ConfD is running in HA slave mode.</p><p>If start of the transaction is successful, the function
    returns a new transaction handle, a non-negative integer
    <em class="parameter"><code>thandle</code></em> which must be used as a parameter in all
    API functions which manipulate the transaction.</p><p>We will drive this transaction forward through the different
    states a ConfD transaction goes through. See the ascii arts in
    <a class="link" href="rn02re10.html" title="confd_lib_dp">confd_lib_dp(3)</a> for a
    picture of these states. If an external
    database is used, and it has registered callback functions for the
    different transaction states, those callbacks will be called when
    we in MAAPI invoke the different MAAPI transaction manipulation
    functions. For example when we call
    <code class="function">maapi_start_trans()</code> the
    <code class="function">init()</code> callback will be invoked in all
    external databases. (However ConfD may delay the actual invocation
    of <code class="function">init()</code> as an optimization, see <a class="link" href="rn02re10.html" title="confd_lib_dp">confd_lib_dp(3)</a>.) If data is kept
    in CDB, ConfD will handle everything internally.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_TOOMANYTRANS, CONFD_ERR_BADSTATE,
    CONFD_ERR_NOT_WRITABLE</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If we want to start new transactions inside actions, we can
    use this function to execute the new transaction within the
    existing user session.  It is equivalent to calling
    <code class="function">maapi_set_user_session()</code> and then
    <code class="function">maapi_start_trans()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_TOOMANYTRANS, CONFD_ERR_BADSTATE,
    CONFD_ERR_NOT_WRITABLE</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans_flags</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function makes it possible to set the flags that can
    otherwise be used with <code class="function">maapi_set_flags()</code>
    already when starting a transaction, as well as setting the
    <code class="constant">MAAPI_FLAG_HIDE_INACTIVE</code> and
    <code class="constant">MAAPI_FLAG_DELAYED_WHEN</code> flags that can only be
    used with <code class="function">maapi_start_trans_flags()</code>. See the
    description of <code class="function">maapi_set_flags()</code> for the
    available flags. It also incorporates the functionality of
    <code class="function">maapi_start_trans()</code> and
    <code class="function">maapi_start_trans2()</code> with respect to user
    sessions: If <em class="parameter"><code>usid</code></em> is 0, the transaction will
    be started within the user session associated with the MAAPI socket
    (like <code class="function">maapi_start_trans()</code>), otherwise it will
    be started within the user session given by
    <em class="parameter"><code>usid</code></em> (like
    <code class="function">maapi_start_trans2()</code>).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_TOOMANYTRANS, CONFD_ERR_BADSTATE,
    CONFD_ERR_NOT_WRITABLE</p><div class="funcsynopsis"><a name="fn.maapi_start_trans_flags2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans_flags2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">dbname</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">vendor</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">product</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">version</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">client_id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as <code class="function">maapi_start_trans_flags()</code>
    but allows additional information about the transaction to be passed to
    <span class="phrase">ConfD</span>.
    Calling <code class="function">maapi_start_trans_flags()</code> is equivalent to
    calling <code class="function">maapi_start_trans_flags2()</code> with
    <em class="parameter"><code>vendor</code></em>, <em class="parameter"><code>product</code></em> and
    <em class="parameter"><code>version</code></em> set to NULL, and <em class="parameter"><code>client_id</code></em>
    set to __MAAPI_CLIENT_ID__. The __MAAPI_CLIENT_ID__ macro (defined in confd_maapi.h)
    will expand to a string representation of __FILE__:__LINE__.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_TOOMANYTRANS, CONFD_ERR_BADSTATE,
    CONFD_ERR_NOT_WRITABLE</p><div class="funcsynopsis"><a name="fn.maapi_start_trans_in_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_trans_in_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_trans_mode <var class="pdparam">readwrite</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function makes it possible to start a transaction with
    another transaction as backend, instead of an actual data store.
    This can be useful if we want to make a set of related changes, and
    then either apply or discard them all based on some criterion, while
    other changes remain unaffected. The <em class="parameter"><code>thandle</code></em>
    identifies the backend transaction to use. If
    <em class="parameter"><code>usid</code></em> is 0, the transaction will be started
    within the user session associated with the MAAPI socket, otherwise
    it will be started within the user session given by
    <em class="parameter"><code>usid</code></em>. If we call
    <code class="function">maapi_apply_trans()</code> for this "transaction in a
    transaction", the changes (if any) will be applied to the backend
    transaction. To discard the changes, call
    <code class="function">maapi_finish_trans()</code> without calling
    <code class="function">maapi_apply_trans()</code> first.</p><p>The changes in this transaction can be validated by calling
    <code class="function">maapi_validate_trans()</code> with a non-zero value
    for <em class="parameter"><code>forcevalidation</code></em>, but calling
    <code class="function">maapi_apply_trans()</code> will not do any validation
    - in either case, the resulting configuration will be validated when
    the backend transaction is committed to the running data store. Note
    though that unlike the case with a transaction directly towards a
    data store, no transaction lock is taken on the underlying data
    store when doing validation of this type of transaction - thus it is
    possible for the contents of the data store to change (due to commit
    of another transaction) during the validation.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_TOOMANYTRANS,
    CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><a name="fn.maapi_finish_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_finish_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This will finish the transaction. If the transaction is
    implemented by an external database, this will invoke the
    <code class="function">finish()</code> callback.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><p>The error CONFD_ERR_NOEXISTS is set for all API functions
    which use a <em class="parameter"><code>thandle</code></em>, the return value from
    <code class="function">maapi_start_trans()</code>, whenever no transaction
    is started.</p><div class="funcsynopsis"><a name="fn.maapi_validate_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_validate_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">unlock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">forcevalidation</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function validates all data written in the
    transaction. This includes all data model constraints and all
    defined semantic validation in C, i.e. user programs that have
    registered functions under validation points.
    (See the <a class="link" href="ch09.html" title="Chapter&nbsp;9.&nbsp;Semantic validation">Semantic Validation
    chapter in the User Guide</a>.)</p><p>If this function returns CONFD_ERR, the transaction is open
    for further editing. There are two special
    <code class="varname">confd_errno</code> values which are of particular
    interest here.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">CONFD_ERR_EXTERNAL</span></dt><dd><p>this means that an external validation program in
          C returns CONFD_ERR i.e. that the
          semantic validation failed. The reason for the failure can
          be found in <code class="function">confd_lasterr()</code></p></dd><dt><span class="term">CONFD_ERR_VALIDATION_WARNING</span></dt><dd><p>This means that an external semantic validation
          program in C returned CONFD_VALIDATION_WARN.
          The string <code class="function">confd_lasterr()</code> is organized
          as a series of NUL terminated strings as in
          <code class="code">keypath1, reason1, keypath2, reason2
          ...</code> where the sequence is terminated with an
          additional NUL</p></dd></dl></div><p>If <em class="parameter"><code>unlock</code></em> is 1, the transaction is open
    for further editing even if validation succeeds. If
    <em class="parameter"><code>unlock</code></em> is 0 and the function returns
    CONFD_OK, the next function to be called MUST be
    <code class="function">maapi_prepare_trans()</code> or
    <code class="function">maapi_finish_trans()</code>.</p><p><em class="parameter"><code>unlock</code></em> = 1 can be used to implement a
    'validate' command which can be given in the middle of an editing
    session.  The first thing that happens is that a lock is set. If
    <em class="parameter"><code>unlock</code></em> == 1, the lock is released on success.
    The lock is always released on failure.</p><p>The <em class="parameter"><code>forcevalidation</code></em> parameter should
    normally be 0. It has no effect for a transaction towards the
    running or startup data stores, validation is always performed. For
    a transaction towards the candidate data store, validation will not
    be done unless <em class="parameter"><code>forcevalidation</code></em> is non-zero.
    Avoiding this validation is preferable if we are going to commit
    the candidate to running (e.g. with
    <code class="function">maapi_candidate_commit()</code>), since otherwise the
    validation will be done twice. However if we are implementing a
    'validate' command, we should give a non-zero value for
    <em class="parameter"><code>forcevalidation</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS, CONFD_ERR_NOTSET,
    CONFD_ERR_NON_UNIQUE, CONFD_ERR_BAD_KEYREF,
    CONFD_ERR_TOO_FEW_ELEMS, CONFD_ERR_TOO_MANY_ELEMS,
    CONFD_ERR_UNSET_CHOICE, CONFD_ERR_MUST_FAILED,
    CONFD_ERR_MISSING_INSTANCE, CONFD_ERR_INVALID_INSTANCE,
    CONFD_ERR_INUSE, CONFD_ERR_BADTYPE, CONFD_ERR_EXTERNAL,
    CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><a name="fn.maapi_prepare_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_prepare_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function must be called as first part of two-phase
    commit.  After this function has been called
    <code class="function">maapi_commit_trans()</code> or
    <code class="function">maapi_abort_trans()</code> must be called.</p><p>It will invoke the prepare callback in all participants in
    the transaction.  If all participants reply with CONFD_OK, the
    second phase of the two-phase commit procedure is
    commenced.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS, CONFD_ERR_EXTERNAL,
    CONFD_ERR_NOTSET, CONFD_ERR_BADSTATE, CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_commit_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_commit_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><div class="funcsynopsis"><a name="fn.maapi_abort_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_abort_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Finally at the last stage, either commit or abort must be
   called. A call to one of these functions must also
   eventually be followed by a call to
   <code class="function">maapi_finish_trans()</code> which will terminate the
   transaction.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS, CONFD_ERR_EXTERNAL,
   CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><a name="fn.maapi_apply_trans"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_apply_trans</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">keepopen</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Invoking the above transaction functions in exactly the right
   order can be a bit complicated.
   The right order to invoke the functions is
   <code class="function">maapi_validate_trans()</code>,
   <code class="function">maapi_prepare_trans()</code>,
   <code class="function">maapi_commit_trans()</code> (or
   <code class="function">maapi_abort_trans()</code>).
   Usually we do not require this fine
   grained control over the two-phase commit protocol. It is easier to
   use <code class="function">maapi_apply_trans()</code> which validates,
   prepares and eventually commits or aborts.</p><p>A call to <code class="function">maapi_apply_trans()</code> must also
   eventually be followed by a call to
   <code class="function">maapi_finish_trans()</code> which will terminate the
   transaction.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>For a readonly transaction, i.e. one started with
   <em class="parameter"><code>readwrite</code></em> == <code class="constant">CONFD_READ</code>,
   or for a read-write transaction where we haven't actually done any
   writes, we do not need to call any of the
   validate/prepare/commit/abort or apply functions, since there is
   nothing for them to do. Calling
   <code class="function">maapi_finish_trans()</code> to terminate the
   transaction is sufficient.</p></div><p>The parameter <em class="parameter"><code>keepopen</code></em> can optionally be
   set to <code class="constant">1</code>, then the changes to the transaction
   are not discarded if validation fails.  This feature is typically
   used by management applications that wish to present the validation
   errors to an operator and allow the operator to fix the validation
   errors and then later retry the apply sequence.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS, CONFD_ERR_NOTSET,
   CONFD_ERR_NON_UNIQUE, CONFD_ERR_BAD_KEYREF,
   CONFD_ERR_TOO_FEW_ELEMS, CONFD_ERR_TOO_MANY_ELEMS,
   CONFD_ERR_UNSET_CHOICE, CONFD_ERR_MUST_FAILED,
   CONFD_ERR_MISSING_INSTANCE, CONFD_ERR_INVALID_INSTANCE,
   CONFD_ERR_INUSE, CONFD_ERR_BADTYPE, CONFD_ERR_EXTERNAL,
   CONFD_ERR_BADSTATE</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.readwrite_functions"></a><h2>READ/WRITE FUNCTIONS</h2><div class="funcsynopsis"><a name="fn.maapi_set_namespace"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_namespace</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If we want to read or write data where the toplevel element
   name is not unique, we must indicate which namespace we are going to
   use. It is possible to change the namespace several times during a
   transaction.</p><p>The <em class="parameter"><code>hashed_ns</code></em> integer is the integer
   which is defined for the namespace in the .h file which is generated
   by the 'confdc' compiler.  It is also possible to indicate which
   namespace to use through the namespace prefix when we read and write
   data. Thus the path <code class="sgmltag-element">/foo:bar/baz</code> will get us
   <code class="sgmltag-element">/bar/baz</code> in the namespace with prefix "foo" regardless of
   what the "set" namespace is. And if there is only one toplevel
   element called "bar" across all namespaces, we can use
   <code class="sgmltag-element">/bar/baz</code> without the prefix and without calling
   <code class="function">maapi_set_namespace()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function mimics the behavior of the UNIX "cd"
   command. It changes our working position in the data tree. If we are
   worried about performance, it is more efficient to invoke
   <code class="function">maapi_cd()</code> to some position in the tree
   and there perform a series of operations using relative paths than
   it is to perform the equivalent series of operations using absolute
   paths. Note that this function can not be used as an existence
   test.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_pushd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_pushd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Behaves like <code class="function">maapi_cd()</code> with the
   exception that we can subsequently call
   <code class="function">maapi_popd()</code> and returns to the previous
   position in the data tree.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOSTACK,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_popd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_popd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Pops the top position of the directory stack and changes
   directory.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOSTACK,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_getcwd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_getcwd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>size_t <var class="pdparam">strsz</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">curdir</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Returns the current position as previously set by
   <code class="function">maapi_cd()</code>, <code class="function">maapi_pushd()</code>,
   or <code class="function">maapi_popd()</code> as a string. Note that what is
   returned is a pretty-printed version of the internal
   representation of the current position, it will be the shortest
   unique way to print the path but it might not exactly match the
   string given to <code class="function">maapi_cd()</code>. The buffer in
   *curdir will be NULL terminated, and no more characters than
   strsz-1 will be written to it.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC,
   CONFD_ERR_OS, CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_getcwd_kpath"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_getcwd_kpath</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_hkeypath_t **<var class="pdparam">kp</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Returns the current position like
   <code class="function">maapi_getcwd()</code>, but as a pointer to a hashed
   keypath instead of as a string.  The hkeypath is dynamically
   allocated, and may further contain dynamically allocated
   elements. The caller must free the allocated memory, easiest done
   by calling <code class="function">confd_free_hkeypath()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC,
   CONFD_ERR_OS, CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_exists"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_exists</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Boolean function which return 1 if the path refers to an
   existing node in the data tree, 0 if it does not.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_num_instances"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_num_instances</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Returns the number of entries for a list in the data tree.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_get_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function reads a value from the path in
   <em class="parameter"><code>fmt</code></em> and writes the result into the result
   parameter <span class="type">confd_value_t</span>. The path must lead to a leaf
   node in the data tree. Note that for the C_BUF, C_BINARY, C_LIST,
   C_OBJECTREF, C_OID, C_QNAME, C_HEXSTR, and C_BITBIG
   <span class="type">confd_value_t</span> types, the buffer(s) pointed to are
   allocated using malloc(3) - it is up to the user of this interface to
   free them using <code class="function">confd_free_value()</code>.</p><p>The maapi interface also contains a long list of access
   functions that accompany the <code class="function">maapi_get_elem()</code>
   function which is a general access function that returns a
   <span class="type">confd_value_t</span>. The accompanying functions all have the
   format <code class="function">maapi_get_&lt;type&gt;_elem()</code> where
   &lt;type&gt; is one of the actual C types a
   <span class="type">confd_value_t</span> can have. For example the
   function:</p><div class="informalexample"><pre class="programlisting">maapi_get_int64_elem(int sock, int thandle, int64_t *rval,
                                const char *fmt, ...);</pre></div><p>is used to read a signed 64 bit integer. It fills in the
   provided <span class="type">int64_t</span> parameter. This corresponds
   to the YANG datatype int64, see <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a>.  Similar
   access functions are provided for all the different builtin
   types.</p><p>One access function that needs additional explaining is the
   <code class="function">maapi_get_str_elem()</code>. This function copies
   at most <code class="code">n-1</code> characters into a user provided
   buffer, and terminates the string with a NUL character.  If the
   buffer is not sufficiently large CONFD_ERR is returned, and
   <code class="varname">confd_errno</code> is set to CONFD_ERR_PROTOUSAGE.
   Note it is always possible to use maapi_get_elem() to get hold of
   the <span class="type">confd_value_t</span>, which in the case of a string buffer
   contains the length.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_PROTOUSAGE, CONFD_ERR_BADTYPE</p><p>


  </p><div class="funcsynopsis"><a name="fn.maapi_get_int8_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int8_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int8_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_int16_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int16_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int16_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_int32_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int32_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_int64_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_int64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int64_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_u_int8_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int8_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int8_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_u_int16_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int16_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int16_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_u_int32_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int32_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_u_int64_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_u_int64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int64_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_ipv4_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv4_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct in_addr *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_ipv6_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv6_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct in6_addr *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_double_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_double_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>double *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_bool_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bool_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_datetime_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_datetime_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_datetime *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_date_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_date_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_date *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_gyearmonth_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_gyearmonth_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_gYearMonth *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_gyear_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_gyear_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_gYear *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_time_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_time_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_time *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_gday_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_gday_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_gDay *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_gmonthday_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_gmonthday_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_gMonthDay *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_month_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_month_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_gMonth *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_duration_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_duration_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_duration *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_enum_value_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_enum_value_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_bit32_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bit32_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">th</var>, </td></tr><tr><td>&nbsp;</td><td>int32_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_bit64_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_bit64_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">th</var>, </td></tr><tr><td>&nbsp;</td><td>int64_t *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_oid_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_oid_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">th</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_snmp_oid **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_buf_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_buf_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">bufsiz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_str_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_str_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">th</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_binary_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_binary_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">bufsiz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_qname_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_qname_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">prefix</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">prefixsz</var>, </td></tr><tr><td>&nbsp;</td><td>unsigned char **<var class="pdparam">name</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">namesz</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_list_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_list_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">th</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_ipv4prefix_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv4prefix_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_ipv4_prefix *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>

  </p><div class="funcsynopsis"><a name="fn.maapi_get_ipv6prefix_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_ipv6prefix_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_ipv6_prefix *<var class="pdparam">rval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>
</p><p>Similar to the CDB API, MAAPI also includes typesafe variants
   for all the builtin types. See <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a>.</p><div class="funcsynopsis"><a name="fn.maapi_vget_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_vget_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>va_list <var class="pdparam">args</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
   <code class="function">maapi_get_elem()</code>, but takes a single
   <span class="type">va_list</span> argument instead of a variable number of
   arguments - i.e. similar to
   <code class="function">vprintf()</code>. Corresponding <span class="type">va_list</span>
   variants exist for all the functions that take a path as a variable
   number of arguments.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_PROTOUSAGE, CONFD_ERR_BADTYPE</p><div class="funcsynopsis"><a name="fn.maapi_init_cursor"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_init_cursor</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>struct maapi_cursor *<var class="pdparam">mc</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Whenever we wish to iterate over the entries in a list in the data
   tree, we must first initialize a cursor. The cursor is subsequently
   used in a while loop.</p><p>For example if we have:</p><div class="informalexample"><pre class="programlisting">container servers {
  list server {
    key name;
    max-elements 64;
    leaf name {
      type string;
    }
    leaf ip {
      type inet:ip-address;
    }
    leaf port {
      type inet:port-number;
      mandatory true;
    }
  }
}
</pre></div><p>We can have the following C code which iterates over all
   <code class="sgmltag-element">server</code> entries.</p><div class="informalexample"><pre class="programlisting">struct maapi_cursor mc;

maapi_init_cursor(sock, th, &amp;mc, "/servers/server");
maapi_get_next(&amp;mc);
while (mc.n != 0) {
   ... do something
   maapi_get_next(&amp;mc);
}
maapi_destroy_cursor(&amp;mc);</pre></div><p>When a <code class="code">tailf:secondary-index</code> statement is used in
   the data model (see <a class="link" href="rn03re20.html" title="tailf_yang_extensions">tailf_yang_extensions(5)</a>),
   we can set the
   <code class="varname">secondary_index</code> element of the
   <span class="type">struct maapi_cursor</span> to indicate the name of a
   chosen secondary index - this must be done after the call to
   <code class="function">maapi_init_cursor()</code> (which sets
   <code class="varname">secondary_index</code> to NULL) and before any call
   to <code class="function">maapi_get_next()</code>. In this case,
   <code class="varname">secondary_index</code> must point to a NUL-terminated
   string that is valid throughout the iteration.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_get_next"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_next</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Iterates and gets the keys for the next entry in a list. The key(s)
   can be used to retrieve further data. The key(s) are stored as
   <span class="type">confd_value_t</span> structures in an array inside the
   <span class="type">struct maapi_cursor</span>. The array of keys will be
   deallocated by the library.</p><p>For example to read the <code class="sgmltag-element">port</code> leaf
   from an entry in the <code class="sgmltag-element">server</code> list above, we would do:</p><div class="informalexample"><pre class="programlisting">....
maapi_init_cursor(sock, th, &amp;mc, "/servers/server");
maapi_get_next(&amp;mc);
while (mc.n != 0) {
   confd_value_t v;
   maapi_get_elem(sock, th, &amp;v, "/servers/server{%x}/port", &amp;mc.keys[0]);
   ....
   maapi_get_next(&amp;mc);
}</pre></div><p>The '%*x' modifier (see the PATHS section in <a class="link" href="rn02re09.html#man.3.confd_lib_cdb.paths" title="PATHS">confd_lib_cdb(3)</a>) is
   especially useful when working with a maapi cursor. The example above
   assumes that we know that the <code class="sgmltag-element">/servers/server</code> list has
   exactly one key. But we can alternatively write
   <code class="code">maapi_get_elem(sock, th, &amp;v, "/servers/server{%*x}/port",
   mc.n, mc.keys);</code> - which works regardless of the number of keys
   that the list has.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_find_next"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_find_next</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_find_next_type <var class="pdparam">type</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">inkeys</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n_inkeys</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>
     Update the cursor <em class="parameter"><code>mc</code></em> with the key(s) for the
     list entry designated by the <em class="parameter"><code>type</code></em> and
     <em class="parameter"><code>inkeys</code></em> parameters. This function may be used
     to start a traversal from an arbitrary entry in a list. Keys for
     subsequent entries may be retrieved with the
     <code class="function">maapi_get_next()</code> function.
   </p><p>
     The <em class="parameter"><code>inkeys</code></em> array is populated with
     <em class="parameter"><code>n_inkeys</code></em> values that designate the starting
     point in the list. Normally the array is populated with key values
     for the list, but if the <code class="varname">secondary_index</code> element
     of the cursor has been set, the array must instead be populated
     with values for the corresponding secondary index-leafs. The
     <em class="parameter"><code>type</code></em> can have one of two values:
   </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">CONFD_FIND_NEXT</code></span></dt><dd><p>The keys for the first list entry
         <span class="emphasis"><em>after</em></span> the one indicated by the
         <em class="parameter"><code>inkeys</code></em> array are requested. The
         <em class="parameter"><code>inkeys</code></em> array does not have to correspond
         to an actual existing list entry. Furthermore the number of
         values provided in the array (<em class="parameter"><code>n_inkeys</code></em>)
         may be fewer than the number of keys (or number of index-leafs
         for a secondary-index) in the data model, possibly even
         zero. This indicates that only the first
         <em class="parameter"><code>n_inkeys</code></em> values are provided, and the
         remaining ones should be taken to have a value "earlier" than
         the value for any existing list entry.</p></dd><dt><span class="term"><code class="constant">CONFD_FIND_SAME_OR_NEXT</code></span></dt><dd><p>If the values in the <em class="parameter"><code>inkeys</code></em> array
         completely identify an actual existing list entry, the keys for
         this entry are requested. Otherwise the same logic as
         described for <code class="constant">CONFD_FIND_NEXT</code> is used.</p></dd></dl></div><p>The following example will traverse the <code class="sgmltag-element">server</code> list
   starting with the first entry (if any) that has a key value that is
   after "smtp" in the list order:</p><div class="informalexample"><pre class="programlisting">....
confd_value_t inkeys[1];

maapi_init_cursor(sock, th, &amp;mc, "/servers/server");
CONFD_SET_STR(&amp;inkeys[0], "smtp");

maapi_find_next(&amp;mc, CONFD_FIND_NEXT, inkeys, 1);
while (mc.n != 0) {
   confd_value_t v;
   maapi_get_elem(sock, th, &amp;v, "/servers/server{%x}/port", &amp;mc.keys[0]);
   ....
   maapi_get_next(&amp;mc);
}</pre></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_destroy_cursor"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void <b class="fsfunc">maapi_destroy_cursor</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Deallocates memory which is associated with the cursor.</p><div class="funcsynopsis"><a name="fn.maapi_set_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><div class="funcsynopsis"><a name="fn.maapi_set_elem2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_elem2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">strval</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We have two different functions to set values. One where the
   value is a string and one where the value to set is a
   <span class="type">confd_value_t</span>. The string version is useful when we
   have implemented a management agent where the user enters values as
   strings. The version with <span class="type">confd_value_t</span> is useful when
   we are setting values which we have just read.</p><p>Another note which might effect users is that if the type we
   are writing is any of the encrypt or hash types, the
   <code class="function">maapi_set_elem2()</code> will perform the asymmetric
   conversion of values whereas the
   <code class="function">maapi_set_elem()</code> will not.
   See <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a>, the
   types <span class="type">tailf:md5-digest-string</span>,
   <span class="type">tailf:des3-cbc-encrypted-string</span>, and
   <span class="type">tailf:aes-cfb-128-encrypted-string</span>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_vset_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_vset_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>va_list <var class="pdparam">args</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
   <code class="function">maapi_set_elem()</code>, but takes a single
   <span class="type">va_list</span> argument instead of a variable number of
   arguments - i.e. similar to
   <code class="function">vprintf()</code>. Corresponding <span class="type">va_list</span>
   variants exist for all the functions that take a path as a variable
   number of arguments.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_create"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_create</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Create a new list entry, a <code class="code">presence</code> container, or
   a leaf of type <code class="code">empty</code> in the data tree. For
   example: <code class="code">maapi_create(sock,th,"/servers/server{www}");</code></p><p>If we are creating a new server entry as above, we must
   also populate all other data nodes below, which do not have a
   default value in the data model. Thus we must also do e.g.:</p><p><code class="code">maapi_set_elem2(sock, th, "80",
   "/servers/server{www}/port");</code></p><p>before we try to commit the data.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_NOTCREATABLE, CONFD_ERR_INUSE,
   CONFD_ERR_ALREADY_EXISTS</p><div class="funcsynopsis"><a name="fn.maapi_delete"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_delete</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Delete an existing list entry, a <code class="code">presence</code>
   container, or an optional leaf
   and all its children (if any) from the data tree.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_NOTDELETABLE, CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_get_object"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_object</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function reads at most <em class="parameter"><code>n</code></em> values
   from the list entry or container specified by the path, and places them
   in the <em class="parameter"><code>values</code></em> array, which is provided by the
   caller. The array is populated according to the specification of
   the Value Array format in the <a class="link" href="rn02re15.html#man.3.confd_types.xml_structures" title="XML STRUCTURES">XML STRUCTURES</a>
   section of the <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a> manual
   page.</p><p>On success, the function returns the actual number of
   elements needed. I.e. if the return value is bigger than
   <em class="parameter"><code>n</code></em>, only the values for the first
   <em class="parameter"><code>n</code></em> elements are in the array, and the remaining
   values have been discarded. Note that given the specification of
   the array contents, there is always a fixed upper bound on the
   number of actual elements, and if there are no <code class="code">presence</code>
   sub-containers, the number is constant. See the description of
   <code class="function">cdb_get_object()</code> in <a class="link" href="rn02re09.html" title="confd_lib_cdb">confd_lib_cdb(3)</a> for
   usage examples - they apply to
   <code class="function">maapi_get_object()</code> as well.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_get_objects"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_objects</b>(</code></td><td>struct maapi_cursor *<var class="pdparam">mc</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nobj</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Similar to <code class="function">maapi_get_object()</code>, but reads
   multiple list entries based on a <span class="type">struct maapi_cursor</span>.
   At most <em class="parameter"><code>n</code></em> values from each of at most
   <em class="parameter"><code>*nobj</code></em> list entries, starting at the entry
   after the one given by <em class="parameter"><code>*mc</code></em>, are read and
   placed in the <em class="parameter"><code>values</code></em> array. The cursor must
   have been initialized with <code class="function">maapi_init_cursor()</code>
   at some point before the call, but in principle it is possible to mix
   calls to <code class="function">maapi_get_next()</code> and
   <code class="function">maapi_get_objects()</code> using the same
   cursor.</p><p>The array must be at least <code class="code">n * *nobj</code> elements
   long, and the values for entry <code class="code">i</code> start at element
   <code class="code">array[i * n]</code> (i.e. the first entry read starts at
   <code class="code">array[0]</code>, the second at <code class="code">array[n]</code>, and so
   on). On success, the highest actual number of values in any of the
   entries read is returned. If we attempt to read more entries than
   actually exist (i.e. if there are less than
   <em class="parameter"><code>*nobj</code></em> entries after the entry indicated by
   <em class="parameter"><code>*mc</code></em>), <em class="parameter"><code>*nobj</code></em> is updated
   with the actual number (possibly 0) of entries read. In this case the
   <code class="varname">n</code> element of the cursor is set to 0 as for
   <code class="function">maapi_get_next()</code>. Example - read the data for
   all entries in the "server" list above, in chunks of 10:</p><div class="informalexample"><pre class="programlisting">#define VALUES_PER_ENTRY 3
#define ENTRIES_PER_REQUEST 10

struct maapi_cursor mc;
confd_value_t v[ENTRIES_PER_REQUEST*VALUES_PER_ENTRY];
int nobj, ret, i;

maapi_init_cursor(sock, th, &amp;mc, "/servers/server");
do {
    nobj = ENTRIES_PER_REQUEST;
    ret = maapi_get_objects(&amp;mc, v, VALUES_PER_ENTRY, &amp;nobj);
    if (ret &gt;= 0) {
        for (i = 0; i &lt; nobj; i++) {
            ... process entry starting at v[i*VALUES_PER_ENTRY] ...
        }
    } else {
        ... handle error ...
    }
} while (ret &gt;= 0 &amp;&amp; mc.n != 0);
maapi_destroy_cursor(&amp;mc);</pre></div><p>See also the description of
   <code class="function">cdb_get_object()</code> in <a class="link" href="rn02re09.html" title="confd_lib_cdb">confd_lib_cdb(3)</a> for
   examples on how to use loaded schema information to avoid
   "hardwiring" constants like VALUES_PER_ENTRY above, and the relative
   position of individual leaf values in the value array.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_PROTOUSAGE,
   CONFD_ERR_NOEXISTS, CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_get_values"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_values</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Read an arbitrary set of sub-elements of a container
   or list entry. The <em class="parameter"><code>values</code></em> array must be
   pre-populated with <em class="parameter"><code>n</code></em> values based on the
   specification of the <span class="emphasis"><em>Tagged Value Array</em></span>
   format in the <span class="emphasis"><em>XML STRUCTURES</em></span> section of the
   <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a> manual
   page, where the <span class="type">confd_value_t</span> value element is given
   as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>C_NOEXISTS means that the value should be read from the
       transaction and stored in the array.</p></li><li class="listitem"><p>C_PTR also means that the value should be read from the
       transaction, but instead gives the expected type and a pointer to the
       type-specific variable where the value should be stored.  Thus
       this gives a functionality similar to the type safe
       <code class="function">maapi_get_xxx_elem()</code> functions.</p></li><li class="listitem"><p>C_XMLBEGIN and C_XMLEND are used as per the
       specification.</p></li><li class="listitem"><p>Keys to select list entries can
       be given with their values.</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>When we use C_PTR, we need to take special care to free
   any allocated memory. When we use C_NOEXISTS and the value is stored
   in the array, we can just use
   <code class="function">confd_free_value()</code> regardless of the type,
   since the <span class="type">confd_value_t</span> has the type information. But
   with C_PTR, only the actual value is stored in the pointed-to
   variable, just as for <code class="function">maapi_get_buf_elem()</code>,
   <code class="function">maapi_get_binary_elem()</code>, etc, and we need to
   free the memory specifically allocated for the types listed in the
   description of <code class="function">maapi_get_elem()</code> above. The
   details of how to do this are not given for the
   <code class="function">maapi_get_xxx_elem()</code> functions here, but it is
   the same as for the corresponding <code class="function">cdb_get_xxx()</code>
   functions, see <a class="link" href="rn02re09.html" title="confd_lib_cdb">confd_lib_cdb(3)</a>.</p></div><p>All elements have the same position in the array after the
   call, in order to simplify extraction of the values - this means
   that optional elements that were requested but didn't exist will
   have C_NOEXISTS rather than being omitted from the array. However
   requesting a list entry that doesn't exist is an error. Note
   that when using C_PTR, the only indication of a non-existing value
   is that the destination variable has not been modified - it's up
   to the application to set it to some "impossible" value before the
   call when optional leafs are read.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Selection of a list entry by its "instance integer",
   which can be done with <code class="function">cdb_get_values()</code> by
   using C_CDBBEGIN, can <span class="emphasis"><em>not</em></span> be done with
   <code class="function">maapi_get_values()</code></p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_BADTYPE,
   CONFD_ERR_NOEXISTS, CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_set_object"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_object</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const confd_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set all leafs corresponding to the complete contents of a
   list entry or container, excluding for sub-lists. The
   <em class="parameter"><code>values</code></em> array must be populated with
   <em class="parameter"><code>n</code></em> values according to the specification of
   the Value Array format in the <a class="link" href="rn02re15.html#man.3.confd_types.xml_structures" title="XML STRUCTURES">XML STRUCTURES</a>
   section of the <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a> manual
   page. Additionally, since operational data cannot be written, array
   elements corresponding to operational data leafs or containers must
   have the value C_NOEXISTS.</p><p>If the node specified by the path, or any sub-nodes that are
   specified as existing, do not exist before this call, they will be
   created, otherwise the existing values will be updated. Nodes that
   can be deleted and are specified as not existing in the array,
   i.e. with value C_NOEXISTS, will be deleted if they existed before
   the call.</p><p>For a list entry, since the key values must be
   present in the array, it is not required that the key values are
   included in the path given by <em class="parameter"><code>fmt</code></em>. If the key
   values <span class="emphasis"><em>are</em></span> included in the path, the key values
   in the array are ignored.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_set_values"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_values</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const confd_tag_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set arbitrary sub-elements of a container or list entry. The
   <em class="parameter"><code>values</code></em> array must be populated with
   <em class="parameter"><code>n</code></em> values according to the specification of
   the <span class="emphasis"><em>Tagged Value Array</em></span> format in the
   <span class="emphasis"><em>XML STRUCTURES</em></span> section of the <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a> manual
   page.</p><p>If the container or list entry itself, or any sub-elements that
   are specified as existing, do not exist before this call, they
   will be created, otherwise the existing values will be
   updated. Both mandatory and optional elements may be omitted
   from the array, and all omitted elements are left unchanged. To
   actually delete a non-mandatory leaf or presence container as
   described for
   <code class="function">maapi_set_object()</code>, it may (as an extension of
   the format) be specified as C_NOEXISTS instead of being
   omitted.</p><p>For a list entry, the key values can be specified
   either in the path or via key elements in the array - if the
   values are in the path, the key elements can be omitted from the
   array. For sub-lists present in the array, the key
   elements must of course always also be present though, immediately
   following the C_XMLBEGIN element and in the order defined by the
   data model. It is also possible to delete a list entry by using a
   C_XMLBEGINDEL element, followed by the keys in data model order,
   followed by a C_XMLEND element.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_get_case"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_case</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">choice</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">rcase</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>When we use the YANG <code class="code">choice</code> statement in the data
   model, this function can be used to find the currently selected
   <code class="code">case</code>,
   avoiding useless <code class="function">maapi_get_elem()</code> etc requests
   for nodes that belong to other cases. The <em class="parameter"><code>fmt,
   ...</code></em> arguments give the path to the list entry or
   container where the
   choice is defined, and <em class="parameter"><code>choice</code></em> is the name of
   the choice.  The case value is returned to the
   <span class="type">confd_value_t</span> that <em class="parameter"><code>rcase</code></em> points
   to, as type C_XMLTAG - i.e. we can use the
   <code class="function">CONFD_GET_XMLTAG()</code> macro to retrieve the
   hashed tag value.</p><p>If we have "nested" choices, i.e. multiple levels of
   <code class="code">choice</code> statements without intervening
   <code class="code">container</code> or <code class="code">list</code> statements in the data
   model, the <em class="parameter"><code>choice</code></em> argument must give a
   '/'-separated path with alternating choice and case names, from the
   data node given by the <em class="parameter"><code>fmt, ...</code></em> arguments to
   the specific choice that the request pertains to.</p><p>For a choice without a <code class="code">mandatory true</code>
   statement where no case is currently selected,
   the function will fail with CONFD_ERR_NOEXISTS if the choice
   doesn't have a default case. If it has a default case, it will be
   returned unless the MAAPI_FLAG_NO_DEFAULTS flag is in effect (see
   <code class="function">maapi_set_flags()</code> below) - if the flag is set,
   the value returned via <em class="parameter"><code>rcase</code></em> will have type
   C_DEFAULT.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED</p><div class="funcsynopsis"><a name="fn.maapi_get_attrs"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_attrs</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t *<var class="pdparam">attrs</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_attrs</var>, </td></tr><tr><td>&nbsp;</td><td>confd_attr_value_t **<var class="pdparam">attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">num_vals</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Retrieve attributes for a configuration node. These attributes
   are currently supported:</p><div class="informalexample"><pre class="programlisting">/* CONFD_ATTR_TAGS: value is C_LIST of C_BUF/C_STR */
#define CONFD_ATTR_TAGS       0x80000000
/* CONFD_ATTR_ANNOTATION: value is C_BUF/C_STR */
#define CONFD_ATTR_ANNOTATION 0x80000001
/* CONFD_ATTR_INACTIVE: value is C_BOOL 1 (i.e. "true") */
#define CONFD_ATTR_INACTIVE   0x00000000
/* CONFD_ATTR_BACKPOINTER: value is C?LIST of C_BUF/C_STR */
#define CONFD_ATTR_BACKPOINTER 0x80000003

</pre></div><p>The <em class="parameter"><code>attrs</code></em> parameter is an array of
   attributes of length <em class="parameter"><code>num_attrs</code></em>, specifying the
   wanted attributes - if <em class="parameter"><code>num_attrs</code></em> is 0, all
   attributes are retrieved.  If no attributes are found,
   <em class="parameter"><code>*num_vals</code></em> is set to 0, otherwise an array of
   <span class="type">confd_attr_value_t</span> elements is allocated and populated,
   its address stored in <em class="parameter"><code>*attr_vals</code></em>, and
   <em class="parameter"><code>*num_vals</code></em> is set to the number of elements in
   the array. The <span class="type">confd_attr_value_t</span> struct is defined
   as:</p><div class="informalexample"><a name="struct.confd_attr_value"></a><pre class="programlisting"><strong class="hl-keyword">typedef</strong> <strong class="hl-keyword">struct</strong> confd_attr_value {
    u_int32_t attr;
    confd_value_t v;
} confd_attr_value_t;</pre></div><p>If any attribute values are returned
   (<em class="parameter"><code>*num_vals</code></em> &gt; 0), the caller must free the
   allocated memory by calling
   <code class="function">confd_free_value()</code> for each of the
   <span class="type">confd_value_t</span> elements, and
   <code class="function">free(3)</code> for the
   <em class="parameter"><code>*attr_vals</code></em> array itself.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_UNAVAILABLE</p><div class="funcsynopsis"><a name="fn.maapi_set_attr"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_attr</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>u_int32_t <var class="pdparam">attr</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set an attribute for a configuration node. See
   <code class="function">maapi_get_attrs()</code> above for the supported
   attributes. To delete an attribute, call the function with a value of
   type C_NOEXISTS.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_BADTYPE,
   CONFD_ERR_NOEXISTS, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_UNAVAILABLE</p><div class="funcsynopsis"><a name="fn.maapi_delete_all"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_delete_all</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_delete_how <var class="pdparam">how</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function can be used to delete "all" the configuration
   data within a transaction. The <em class="parameter"><code>how</code></em> argument
   specifies the extent of "all":</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">MAAPI_DEL_SAFE</code></span></dt><dd><p>Delete everything except namespaces that were exported
         to none (with <code class="code">tailf:export none</code>). Toplevel nodes
         that cannot be deleted due to AAA rules are silently left in
         place, but descendant nodes will still be deleted if the AAA
         rules allow it.</p></dd><dt><span class="term"><code class="constant">MAAPI_DEL_EXPORTED</code></span></dt><dd><p>Delete everything except namespaces that were exported
         to none (with <code class="code">tailf:export none</code>).  AAA rules are
         ignored, i.e. nodes are deleted even if the AAA rules don't
         allow it.</p></dd><dt><span class="term"><code class="constant">MAAPI_DEL_ALL</code></span></dt><dd><p>Delete everything. AAA rules are ignored.</p></dd></dl></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_revert"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_revert</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function removes all changes done to the transaction.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_flags"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_flags</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We can modify some aspects of the read/write session by
   calling this function - these values can be used for the
   <em class="parameter"><code>flags</code></em> argument (ORed together if more than
   one) with this function and/or with
   <code class="function">maapi_start_trans_flags()</code>:</p><div class="informalexample"><pre class="programlisting">#define MAAPI_FLAG_HINT_BULK     (1 &lt;&lt; 0)
#define MAAPI_FLAG_NO_DEFAULTS   (1 &lt;&lt; 1)
#define MAAPI_FLAG_CONFIG_ONLY   (1 &lt;&lt; 2)
#define MAAPI_FLAG_HIDE_INACTIVE (1 &lt;&lt; 3) /* maapi_start_trans_flags() only */
#define MAAPI_FLAG_DELAYED_WHEN  (1 &lt;&lt; 6) /* maapi_start_trans_flags() only */
</pre></div><p>MAAPI_FLAG_HINT_BULK tells the ConfD backplane that we will
   be reading substantial amounts of data. This has the effect that
   the <code class="function">get_object()</code> and
   <code class="function">get_next_object()</code> callbacks (if available) are
   used towards external data providers when we call
   <code class="function">maapi_get_elem()</code> etc and
   <code class="function">maapi_get_next()</code>.
   The <code class="function">maapi_get_object()</code> function always
   operates as if this flag was set.</p><p>MAAPI_FLAG_NO_DEFAULTS says that we want to be informed when
   we read leafs with default values that have not had a value
   set. This is indicated by the returned value being of type
   C_DEFAULT instead of the actual value. The default value for such
   leafs can be obtained from the
   <span class="type">confd_cs_node</span> tree provided by the library
   (see <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a>).</p><p>MAAPI_FLAG_CONFIG_ONLY will make the maapi_get_xxx()
   functions return config nodes only - if we attempt to read
   operational data, it will be treated as if the nodes did not
   exist. This is mainly useful in conjunction with
   <code class="function">maapi_get_object()</code> and list entries or
   containers that have
   both config and operational data (the operational data nodes in
   the returned array will have the "value" C_NOEXISTS), but the other
   functions also obey the flag.</p><p>MAAPI_FLAG_HIDE_INACTIVE can only be used with
   <code class="function">maapi_start_trans_flags()</code>, and only when
   starting a readonly transaction (parameter
   <em class="parameter"><code>readwrite</code></em> == <code class="constant">CONFD_READ</code>).
   It will hide configuration data that has the
   <code class="constant">CONFD_ATTR_INACTIVE</code> attribute set, i.e. it will
   appear as if that data does not exist.</p><p>MAAPI_FLAG_DELAYED_WHEN can also only be used with
   <code class="function">maapi_start_trans_flags()</code>, but regardless of
   whether the flag is used or not, the "delayed when" mode can
   subsequently be changed with
   <code class="function">maapi_set_delayed_when()</code>. The flag is only
   meaningful when starting a read-write transaction (parameter
   <em class="parameter"><code>readwrite</code></em> ==
   <code class="constant">CONFD_READ_WRITE</code>), and will cause "delayed when"
   mode to be enabled from the beginning of the transaction. See the
   description of <code class="function">maapi_set_delayed_when()</code> for
   information about the "delayed when" mode.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_delayed_when"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_delayed_when</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">on</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function enables (<em class="parameter"><code>on</code></em> non-zero) or
   disables (<em class="parameter"><code>on</code></em> == 0) the "delayed when" mode of
   a transaction. When successful, it returns 1 or 0 as indication of
   whether "delayed when" was enabled or disabled before the call. See
   also the <code class="constant">MAAPI_FLAG_DELAYED_WHEN</code> flag for
   <code class="function">maapi_start_trans_flags()</code>.</p><p>The YANG <code class="code">when</code> statement makes its parent data
   definition statement conditional. This can be problematic in cases
   where we don't have control over the order of writing different data
   nodes. E.g. when loading configuration from a file, the data that
   will satisfy the <code class="code">when</code> condition may occur after the data
   that the <code class="code">when</code> applies to, making it impossible to
   actually write the latter data into the transaction - since the
   <code class="code">when</code> isn't satisfied, the data nodes effectively do not
   exist in the schema.</p><p>This is addressed by the "delayed when" mode for a transaction.
   When "delayed when" is enabled, it is possible to write to data nodes
   even though they are conditional on a <code class="code">when</code> that isn't
   satisfied. It has no effect on reading though - trying to read data
   that is conditional on an unsatisfied <code class="code">when</code> will always
   result in CONFD_ERR_NOEXISTS or equivalent. When disabling "delayed
   when", any "delayed" <code class="code">when</code> statements will take effect
   immediately - i.e. if the <code class="code">when</code> isn't satisfied at that
   point, the conditional nodes and any data values for them will be
   deleted. If we don't explicitly disable "delayed when" by calling
   this function, it will be automatically disabled when the transaction
   enters the VALIDATE state (e.g. due to call of
   <code class="function">maapi_apply_trans()</code>).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_label"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_label</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">label</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set the "Label" that is stored in the rollback file when a
   transaction towards running is committed. Setting the "Label" for
   transactions via candidate can be done when the candidate is
   committed to running, by using the
   <code class="function">maapi_candidate_commit_info()</code> function. For a
   confirmed commit, the "Label" must also be given via the
   <code class="function">maapi_candidate_confirmed_commit_info()</code>
   function.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_comment"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_comment</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">comment</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set the "Comment" that is stored in the rollback file when a
   transaction towards running is committed. Setting the "Comment" for
   transactions via candidate can be done when the candidate is
   committed to running, by using the
   <code class="function">maapi_candidate_commit_info()</code> function. For a
   confirmed commit, the "Comment" must also be given via the
   <code class="function">maapi_candidate_confirmed_commit_info()</code>
   function.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_NOEXISTS</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.ncs_functions"></a><h2>NCS SPECIFIC FUNCTIONS</h2><p>The functions in this sections can only be used with NCS, and
   specifically the maapi_shared_xxx() functions must be used for NCS
   FASTMAP, i.e. in the service <code class="function">create()</code> callback.
   Those functions maintain attributes that are necessary when multiple
   service instances modify the same data.</p><div class="funcsynopsis"><a name="fn.maapi_shared_create"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_create</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>FASTMAP version of <code class="function">maapi_create()</code>.
   Normally the <em class="parameter"><code>flags</code></em> parameter should be given
   as 0, but it is possible to suppress the creation of backpointer
   attributes by passing <code class="constant">MAAPI_SHARED_NO_BACKPOINTER</code>
   for <em class="parameter"><code>flags</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_NOTCREATABLE, CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_shared_set_elem"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_set_elem</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><div class="funcsynopsis"><a name="fn.maapi_shared_set_elem2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_set_elem2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">strval</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>FASTMAP versions of <code class="function">maapi_set_elem()</code> and
   <code class="function">maapi_set_elem2()</code>. The <em class="parameter"><code>flags</code></em>
   parameter is currently unused and should be given as 0.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_shared_insert"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_insert</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>FASTMAP version of <code class="function">maapi_insert()</code>.
   Normally the <em class="parameter"><code>flags</code></em> parameter should be given
   as 0, but it is possible to suppress the creation of backpointer
   attributes by passing <code class="constant">MAAPI_SHARED_NO_BACKPOINTER</code>
   for <em class="parameter"><code>flags</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_BADTYPE,
   CONFD_ERR_NOT_WRITABLE, CONFD_ERR_NOEXISTS, CONFD_ERR_NOTDELETABLE</p><div class="funcsynopsis"><a name="fn.maapi_shared_set_values"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_set_values</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const confd_tag_value_t *<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>FASTMAP version of <code class="function">maapi_set_values()</code>.
   Normally the <em class="parameter"><code>flags</code></em> parameter should be given
   as 0, but it is possible to suppress the creation of backpointer
   attributes by passing <code class="constant">MAAPI_SHARED_NO_BACKPOINTER</code>
   for <em class="parameter"><code>flags</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_INUSE</p><div class="funcsynopsis"><a name="fn.maapi_shared_copy_tree"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_copy_tree</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">from</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">tofmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>FASTMAP version of <code class="function">maapi_copy_tree()</code>.
   Normally the <em class="parameter"><code>flags</code></em> parameter should be given
   as 0, but it is possible to suppress the creation of backpointer
   attributes by passing <code class="constant">MAAPI_SHARED_NO_BACKPOINTER</code>
   for <em class="parameter"><code>flags</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_NOT_WRITABLE, CONFD_ERR_BADPATH</p><div class="funcsynopsis"><a name="fn.maapi_ncs_apply_template"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_ncs_apply_template</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">template_name</var>, </td></tr><tr><td>&nbsp;</td><td>const struct ncs_name_value *<var class="pdparam">variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">rootfmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Apply a template that has been loaded into NCS. The
   <em class="parameter"><code>template_name</code></em> parameter gives the name of the
   template. The <em class="parameter"><code>variables</code></em> parameter is an
   <em class="parameter"><code>num_variables</code></em> long array of variables and
   names for substitution into the template. The <span class="type">struct
   ncs_name_value</span> is defined as:</p><div class="informalexample"><a name="struct.ncs_name_value"></a><pre class="programlisting"><strong class="hl-keyword">struct</strong> ncs_name_value {
    <strong class="hl-keyword">char</strong> *name;
    <strong class="hl-keyword">char</strong> *value;
};</pre></div><p>The <em class="parameter"><code>flags</code></em> parameter is currently unused
   and should be given as 0.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If this function is called under FASTMAP it will have the
   same behavior as the corresponding FASTMAP function
   <code class="function">maapi_shared_ncs_apply_template()</code>.
   </p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS, CONFD_ERR_XPATH</p><div class="funcsynopsis"><a name="fn.maapi_shared_ncs_apply_template"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_shared_ncs_apply_template</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">template_name</var>, </td></tr><tr><td>&nbsp;</td><td>const struct ncs_name_value *<var class="pdparam">variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_variables</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">rootfmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>FASTMAP version of <code class="function">maapi_ncs_apply_template()</code>.
   Normally the <em class="parameter"><code>flags</code></em> parameter should be given
   as 0.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_NOT_WRITABLE,
   CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS, CONFD_ERR_XPATH</p><div class="funcsynopsis"><a name="fn.maapi_ncs_get_templates"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_ncs_get_templates</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>char ***<var class="pdparam">templates</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">num_templates</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Retrieve a list of the templates currently loaded into NCS. On
   success, a pointer to an array of template names is stored in
   <em class="parameter"><code>templates</code></em> and the length of the array is
   stored in <em class="parameter"><code>num_templates</code></em>. The library allocates
   memory for the result, and the caller is responsible for freeing it.
   This can in all cases be done with code like this:</p><div class="informalexample"><pre class="programlisting">char **templates;
int num_templates, i;

if (maapi_ncs_get_templates(sock, &amp;templates, &amp;num_templates) == CONFD_OK) {
    ...
    for (i = 0; i &lt; num_templates; i++) {
        free(templates[i]);
    }
    if (num_templates &gt; 0) {
        free(templates);
    }
}</pre></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.miscellaneous_functions"></a><h2>MISCELLANEOUS FUNCTIONS</h2><div class="funcsynopsis"><a name="fn.maapi_delete_config"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_delete_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_dbname <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function empties a data store.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_NOSESSION, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_copy"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">from_thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">to_thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If we open two transactions from the same user session but
   towards different data stores, such as one transaction towards
   startup and one towards running, we can copy all data from one
   data store to the other with this function. This is a replace
   operation - any configuration that exists in the transaction given by
   <em class="parameter"><code>to_handle</code></em> but not in the one given by
   <em class="parameter"><code>from_handle</code></em> will be deleted from the
   <em class="parameter"><code>to_handle</code></em> transaction.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_NOT_WRITABLE</p><div class="funcsynopsis"><a name="fn.maapi_copy_path"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">from_thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">to_thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Similar to <code class="function">maapi_copy()</code>, but does a
   replacing copy only of the subtree rooted at the path given by
   <em class="parameter"><code>fmt</code></em> and remaining arguments.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_NOT_WRITABLE</p><div class="funcsynopsis"><a name="fn.maapi_copy_tree"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_copy_tree</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">from</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">tofmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function copies the entire configuration tree rooted at
   <em class="parameter"><code>from</code></em> to <em class="parameter"><code>tofmt</code></em>. List
   entries are created accordingly.  If the destination already
   exists, <em class="parameter"><code>from</code></em> is copied on top of the
   destination. This function is typically used inside actions where
   we for example could use <code class="function">maapi_copy_tree()</code> to
   copy a template configuration into a new list entry. The
   <em class="parameter"><code>from</code></em> path must be pre-formatted, e.g.
   using <code class="function">confd_format_keypath()</code>, whereas the
   destination path is formatted by this function.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The data models for the source and destination trees must
   match - i.e. they must either be identical, or the data model for the
   source tree must be a proper subset of the data model for the
   destination tree. This is always fulfilled when copying from one
   entry to another in a list, or if both source and destination tree
   have been defined via YANG <code class="code">uses</code> statements referencing
   the same <code class="code">grouping</code> definition. If a data model mismatch
   is detected, e.g. an existing data node in the source tree does not
   exist in the destination data model, or an existing leaf in the
   source tree has a value that is incompatible with the type of the
   leaf in the destination data model,
   <code class="function">maapi_copy_tree()</code> will return CONFD_ERR with
   <code class="varname">confd_errno</code> set to
   CONFD_ERR_BADPATH.</p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_NOT_WRITABLE, CONFD_ERR_BADPATH</p><div class="funcsynopsis"><a name="fn.maapi_insert"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_insert</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function inserts a new entry in a list that uses the
   <code class="code">tailf:indexed-view</code> statement.  The key must be of type
   integer. If the inserted entry already exists, the existing and
   subsequent entries will be renumbered as needed, unless renumbering
   would require an entry to have a key value that is outside the range
   of the type for the key. In that case, the function returns CONFD_ERR
   with <code class="varname">confd_errno</code> set to CONFD_ERR_BADTYPE.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_BADTYPE,
   CONFD_ERR_NOT_WRITABLE, CONFD_ERR_NOEXISTS, CONFD_ERR_NOTDELETABLE</p><div class="funcsynopsis"><a name="fn.maapi_move"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_move</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t* <var class="pdparam">tokey</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function moves an existing list entry, i.e. renames the
   entry using the <em class="parameter"><code>tokey</code></em> parameter, which
   is an array containing <em class="parameter"><code>n</code></em> keys.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_NOT_WRITABLE, CONFD_ERR_NOEXISTS, CONFD_ERR_NOTMOVABLE,
   CONFD_ERR_ALREADY_EXISTS</p><div class="funcsynopsis"><a name="fn.maapi_move_ordered"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_move_ordered</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_move_where <var class="pdparam">where</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t* <var class="pdparam">tokey</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>For a list with the YANG <code class="code">ordered-by user</code>
   statement, this function can be used to change the order of entries,
   by moving one entry to a new position. When new entries in
   such a list are created with <code class="function">maapi_create()</code>,
   they are always placed last in the list. The path given by
   <em class="parameter"><code>fmt</code></em> and the remaining arguments identifies the
   entry to move, and the new position is given by the
   <em class="parameter"><code>where</code></em> argument:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MAAPI_MOVE_FIRST</span></dt><dd><p>Move the entry first in the list. The
         <em class="parameter"><code>tokey</code></em> and <em class="parameter"><code>n</code></em>
         arguments are ignored, and can be given as NULL and 0.</p></dd><dt><span class="term">MAAPI_MOVE_LAST</span></dt><dd><p>Move the entry last in the list. The
         <em class="parameter"><code>tokey</code></em> and <em class="parameter"><code>n</code></em>
         arguments are ignored, and can be given as NULL and 0.</p></dd><dt><span class="term">MAAPI_MOVE_BEFORE</span></dt><dd><p>Move the entry to the position before the entry given by
         the <em class="parameter"><code>tokey</code></em> argument, which is an array of
         key values with length <em class="parameter"><code>n</code></em>.</p></dd><dt><span class="term">MAAPI_MOVE_AFTER</span></dt><dd><p>Move the entry to the position after the entry given by
         the <em class="parameter"><code>tokey</code></em> argument, which is an array of
         key values with length <em class="parameter"><code>n</code></em>.</p></dd></dl></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_ACCESS_DENIED,
   CONFD_ERR_NOT_WRITABLE, CONFD_ERR_NOEXISTS, CONFD_ERR_NOTMOVABLE</p><div class="funcsynopsis"><a name="fn.maapi_authenticate"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_authenticate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">user</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">pass</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">groups[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If we are implementing a proprietary management agent with
   MAAPI API, the function
   <code class="function">maapi_start_user_session()</code> requires the
   application to tell ConfD which groups the user are member
   of. ConfD itself has the capability to authenticate users. A MAAPI
   application can use <code class="function">maapi_authenticate()</code> to let
   ConfD authenticate the user, as per the AAA configuration in
   confd.conf</p><p>If the authentication is successful, the function returns
   <code class="constant">1</code>, and the <em class="parameter"><code>groups[]</code></em> array
   is populated with at most <em class="parameter"><code>n-1</code></em> NUL-terminated
   strings containing the group names, followed by a NULL pointer that
   indicates the end of the group list. The strings are dynamically
   allocated, and it is up to the caller to free the memory by calling
   <code class="function">free(3)</code> for each string. If the function is used
   in a context where the group names are not needed, pass
   <code class="constant">1</code> for the <em class="parameter"><code>n</code></em>
   parameter.</p><p>If the authentication fails, the function returns
   <code class="constant">0</code>, and <code class="function">confd_lasterr()</code> (see
   <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>)
   will return a message describing the reason for the failure.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION</p><div class="funcsynopsis"><a name="fn.maapi_authenticate2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_authenticate2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">user</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">pass</var>, </td></tr><tr><td>&nbsp;</td><td>const struct confd_ip *<var class="pdparam">src_addr</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">src_port</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_proto <var class="pdparam">prot</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">groups[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same thing as
   <code class="function">maapi_authenticate()</code>, but allows for passing of
   the additional parameters <em class="parameter"><code>src_addr</code></em>,
   <em class="parameter"><code>src_port</code></em>, <em class="parameter"><code>context</code></em>, and
   <em class="parameter"><code>prot</code></em>, which otherwise are passed only to
   <code class="function">maapi_start_user_session()</code>/<code class="function">maapi_start_user_session2()</code>.
   These parameters are not used when ConfD performs the authentication,
   but they will be passed to an external authentication executable (see
   the <a class="link" href="ch14.html#ug.aaa.External_authentication" title="14.4.4.&nbsp;External authentication">External
   authentication</a> section of the AAA chapter in the User Guide)
   if <code class="sgmltag-element">/confdConfig/aaa/externalAuthentication/includeExtra</code> is
   set to "true" in <code class="filename">confd.conf</code>, see <a class="link" href="rn03re17.html" title="confd.conf">confd.conf(5)</a>. They will also
   be made available to the authentication callback that can be
   registered by an application (see <a class="link" href="rn02re10.html#man.3.confd_lib_dp.authentication_callback" title="AUTHENTICATION CALLBACK">confd_lib_dp(3)</a>).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_PROTOUSAGE,
   CONFD_ERR_MALLOC, CONFD_ERR_OS, CONFD_ERR_NOSESSION</p><div class="funcsynopsis"><a name="fn.maapi_attach"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_attach</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_trans_ctx *<var class="pdparam">ctx</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>While ConfD is executing a transaction, we have a number of
   situations where we wish to invoke user C code which can interact
   in the transaction.  One such situation is when we wish to write
   semantic validation code which is invoked in the validation phase
   of a ConfD transaction. This code needs to execute within the
   context of the executing transaction, it must thus have access to
   the "shadow" storage where all not-yet-committed data is
   kept.</p><p>This function attaches to a existing transaction.
   See the <a class="link" href="ch09.html" title="Chapter&nbsp;9.&nbsp;Semantic validation">Semantic Validation
   chapter in the User Guide</a> for example code.</p><p>Another situation where we wish to attach to the executing
   transaction is when we are using the notifications API and
   subscribe to notification of type CONFD_NOTIF_COMMIT_DIFF and wish
   to read the committed diffs from the transaction.</p><p>The <em class="parameter"><code>hashed_ns</code></em> parameter is basically
   just there to save a call to
   <code class="function">maapi_set_namespace()</code>. We can call
   <code class="function">maapi_set_namespace()</code> any number of times to
   change from the one we passed to
   <code class="function">maapi_attach()</code>, and we can also give the
   namespace in prefix form in the path parameter to the read/write
   functions - see the <code class="function">maapi_set_namespace()</code>
   description.</p><p>If we do not want to give a specific namespace when
   invoking <code class="function">maapi_attach()</code>, we can give 0 for the
   <em class="parameter"><code>hashed_ns</code></em> parameter (-1 works too but is
   deprecated). We can still call the read/write functions as long as
   the toplevel element in the path is unique, but otherwise we must
   call <code class="function">maapi_set_namespace()</code>, or use a prefix in
   the path.</p><div class="funcsynopsis"><a name="fn.maapi_attach2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_attach2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>When we write proprietary CLI commands in C and we wish those
   CLI commands to be able to use MAAPI to read and write data inside
   the same transaction the CLI command was invoked in, we do not have
   an initialized transaction structure available. Then we must use
   this function. CLI commands get the <em class="parameter"><code>usid</code></em>
   passed in UNIX environment variable
   <code class="varname">CONFD_MAAPI_USID</code> and the
   <em class="parameter"><code>thandle</code></em> passed in environment variable
   <code class="varname">CONFD_MAAPI_THANDLE</code>.
   We also need to use this function when implementing such CLI commands
   via action <code class="function">command()</code> callbacks, see the
   <a class="link" href="rn02re10.html" title="confd_lib_dp">confd_lib_dp(3)</a> man page.
   In this case the <em class="parameter"><code>usid</code></em> is provided via
   <code class="varname">uinfo-&gt;usid</code> and the <em class="parameter"><code>thandle</code></em>
   via <code class="varname">uinfo-&gt;actx.thandle</code>.
   To use the user session id that is the owner of the transaction,
   set <em class="parameter"><code>usid</code></em> to 0.
   If the namespace does
   not matter set <em class="parameter"><code>hashed_ns</code></em> to 0, see
   <code class="function">maapi_attach()</code>.</p><div class="funcsynopsis"><a name="fn.maapi_attach_init"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_attach_init</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function is used to attach the MAAPI socket to the
   special transaction available in phase0 used for CDB initialization
   and upgrade. The function is also used if we need to modify CDB data
   during in-service data model upgrade (see the <a class="link" href="ch13.html" title="Chapter&nbsp;13.&nbsp;In-service Data Model Upgrade">"In-service Data Model Upgrade" chapter in
   the User Guide</a>). The transaction handle, which is used in
   subsequent calls to MAAPI, is filled in by the function upon
   successful return. See the <a class="link" href="ch05.html" title="Chapter&nbsp;5.&nbsp;CDB - The ConfD XML Database">CDB
   chapter in the User Guide</a>.</p><div class="funcsynopsis"><a name="fn.maapi_detach"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_detach</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_trans_ctx *<var class="pdparam">ctx</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Detaches an attached MAAPI socket. This function is typically
   called in the <code class="function">stop()</code> callback in validation
   code. An attached MAAPI socket will be automatically detached when
   the ConfD transaction terminates. This function performs an
   explicit detach.</p><div class="funcsynopsis"><a name="fn.maapi_detach2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_detach2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Detaches an attached MAAPI socket when we do not have an
   initialized transaction structure available, see
   <code class="function">maapi_attach2()</code> above. This is mainly useful in
   an action <code class="function">command()</code> callback.</p><div class="funcsynopsis"><a name="fn.maapi_diff_iterate"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_diff_iterate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_op <var class="pdparam">op</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">oldv</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">newv</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function can be called from an attached MAAPI
   session. The purpose of the function is to iterate through the
   transaction diff. It can typically be used in conjunction with the
   notification API when we subscribe to CONFD_NOTIF_COMMIT_DIFF
   events. It can also be used inside validation callbacks.</p><p>For all diffs in the transaction the supplied callback function
   <code class="function">iter()</code> will be called. The
   <code class="function">iter()</code> callback receives the
   <em class="parameter"><code>confd_hkeypath_t kp</code></em> which uniquely identifies
   which node in the data tree that is affected, the operation, and an
   optional value. The <em class="parameter"><code>op</code></em> parameter gives the
   modification as:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MOP_CREATED</span></dt><dd><p>The list entry, <code class="code">presence</code> container, or leaf
         of type <code class="code">empty</code> given
         by <em class="parameter"><code>kp</code></em> has been created.</p></dd><dt><span class="term">MOP_DELETED</span></dt><dd><p>The list entry, <code class="code">presence</code> container, or
         optional leaf given by <em class="parameter"><code>kp</code></em> has been
         deleted.</p></dd><dt><span class="term">MOP_MODIFIED</span></dt><dd><p>A descendant of the list entry
         given by <em class="parameter"><code>kp</code></em> has been
         modified.</p></dd><dt><span class="term">MOP_VALUE_SET</span></dt><dd><p>The value of the leaf given by <em class="parameter"><code>kp</code></em>
         has been set to <em class="parameter"><code>newv</code></em>. If the
         MAAPI_FLAG_NO_DEFAULTS flag has been set and the default value
         for the leaf has come into effect, <em class="parameter"><code>newv</code></em>
         will be of type C_DEFAULT instead of giving the default value.</p></dd><dt><span class="term">MOP_MOVED_AFTER</span></dt><dd><p>The list entry given by <em class="parameter"><code>kp</code></em>, in an
         <code class="code">ordered-by user</code> list, has been moved. If
         <em class="parameter"><code>newv</code></em> is NULL, the entry has been moved
         first in the list, otherwise it has been moved after the entry
         given by <em class="parameter"><code>newv</code></em>. In this case
         <em class="parameter"><code>newv</code></em> is a pointer to an array of key
         values identifying an entry in the list. The array is
         terminated with an element that has type C_NOEXISTS.</p></dd><dt><span class="term">MOP_ATTR_SET</span></dt><dd><p>An attribute for the node given by
         <em class="parameter"><code>kp</code></em> has been modified (see the
         description of <code class="function">maapi_get_attrs()</code> for the
         supported attributes). The <code class="function">iter()</code> callback
         will only get this invocation when attributes are enabled in
         <code class="filename">confd.conf</code>
         (<code class="sgmltag-element">/confdConfig/enableAttributes</code>, see <a class="link" href="rn03re17.html" title="confd.conf">confd.conf(5)</a>)
         <span class="emphasis"><em>and</em></span> the flag
         <code class="constant">ITER_WANT_ATTR</code> has been passed to
         <code class="function">maapi_diff_iterate()</code>. The
         <em class="parameter"><code>newv</code></em> parameter is a pointer to a
         2-element array, where the first element is the attribute
         represented as a <span class="type">confd_value_t</span> of type
         <span class="type">C_UINT32</span> and the second element is the value the
         attribute was set to. If the attribute has been deleted, the
         second element is of type <span class="type">C_NOEXISTS</span>.</p></dd></dl></div><p>The <em class="parameter"><code>oldv</code></em> parameter passed to
   <code class="function">iter()</code> is always NULL.</p><p>If <code class="function">iter()</code> returns ITER_STOP, no more
   iteration is done, and CONFD_OK is returned.  If
   <code class="function">iter()</code> returns ITER_RECURSE iteration
   continues with all children to the node. If
   <code class="function">iter()</code> returns ITER_CONTINUE iteration ignores
   the children to the node (if any), and continues with the node's
   sibling. If, for some reason, the <code class="function">iter()</code>
   function wants to return control to the caller of
   <code class="function">maapi_diff_iterate()</code> <span class="emphasis"><em>before</em></span>
   all the changes have been iterated over it can return
   ITER_SUSPEND. The caller then has to call
   <code class="function">maapi_diff_iterate_resume()</code> to continue/finish the
   iteration.</p><p>The <em class="parameter"><code>flags</code></em> parameter is a bitmask with
   the following bits:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">ITER_WANT_ATTR</span></dt><dd><p>Enable <code class="constant">MOP_ATTR_SET</code> invocations of
         the <code class="function">iter()</code> function.</p></dd><dt><span class="term">ITER_WANT_P_CONTAINER</span></dt><dd><p>Invoke <code class="function">iter()</code> for modified
         presence-containers.</p></dd><dt><span class="term">ITER_WANT_LEAF_LIST_AS_LEAF</span></dt><dd><p>Changes to leaf-lists will cause invocations of
         <code class="function">iter()</code> as for leafs and not as for lists, e.g.
         with MOP_VALUE_SET rather than MOP_CREATED / MOP_DELETED.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>This flag is deprecated, and only present for
         temporary backward compatibility - it will be removed in a
         future release.</p></div></dd></dl></div><p>The <em class="parameter"><code>state</code></em> parameter can be used for any
   user supplied state (i.e. whatever is supplied as
   <em class="parameter"><code>init_state</code></em> is passed as
   <em class="parameter"><code>state</code></em> to <code class="function">iter()</code> in each
   invocation).</p><p>The <code class="function">iter()</code> invocations are not subjected to AAA
   checks, i.e. regardless of which path we have and which context was
   used to create the MAAPI socket, all changes are provided.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS, CONFD_ERR_BADSTATE.</p><p>CONFD_ERR_BADSTATE is returned when we try to iterate on a
   transaction which is in the wrong state and not attached.</p><div class="funcsynopsis"><a name="fn.maapi_keypath_diff_iterate"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_keypath_diff_iterate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_op <var class="pdparam">op</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">oldv</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">newv</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function behaves precisely like the
   <code class="function">maapi_diff_iterate()</code> function except that it
   takes an additional format path argument. This path prunes the diff
   and only changes below the provided path are considered.</p><div class="funcsynopsis"><a name="fn.maapi_diff_iterate_resume"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_diff_iterate_resume</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret <var class="pdparam">reply</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_op <var class="pdparam">op</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">oldv</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">newv</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">resumestate</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>The application <span class="emphasis"><em>must</em></span> call this function to
   finish up the iteration whenever an iterator function for
   <code class="function">maapi_diff_iterate()</code> or
   <code class="function">maapi_keypath_diff_iterate()</code> has returned
   ITER_SUSPEND. If the application does not wish to continue iteration,
   it must at least call <code class="code">maapi_diff_iterate_resume(s, ITER_STOP,
   NULL, NULL);</code> to clean up the state.  The
   <em class="parameter"><code>reply</code></em> parameter is what the iterator function
   would have returned (i.e.  normally ITER_RECURSE or ITER_CONTINUE) if
   it hadn't returned ITER_SUSPEND. Note that it is up to the iterator
   function to somehow communicate that it has returned ITER_SUSPEND to
   the caller of <code class="function">maapi_diff_iterate()</code> or
   <code class="function">maapi_keypath_diff_iterate()</code>, this can for
   example be a field in a struct for which a pointer can be passed back
   and forth via the
   <em class="parameter"><code>state</code></em>/<em class="parameter"><code>resumestate</code></em>
   parameters.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS, CONFD_ERR_BADSTATE.</p><div class="funcsynopsis"><a name="fn.maapi_iterate"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_iterate</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>confd_attr_value_t *<var class="pdparam">attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function can be used to iterate over all the data in a
   transaction and the underlying data store, as opposed to iterating
   over only the changes like <code class="function">maapi_diff_iterate()</code>
   and <code class="function">maapi_keypath_diff_iterate()</code> do. The
   <em class="parameter"><code>fmtpath</code></em> parameter can be used to prune the
   iteration to cover only the subtree below the given path, similar to
   <code class="function">maapi_keypath_diff_iterate()</code> - if
   <em class="parameter"><code>fmtpath</code></em> is given as <code class="constant">"/"</code>,
   there will not be any such pruning. Additionally, if the flag
   <code class="constant">MAAPI_FLAG_CONFIG_ONLY</code> is in effect (see
   <code class="function">maapi_set_flags()</code>), all operational data
   subtrees will be excluded from the iteration.</p><p>The supplied callback function <code class="function">iter()</code> will
   be called for each node in the data tree included in the iteration.
   It receives the <em class="parameter"><code>kp</code></em> parameter which uniquely
   identifies the node, and if the node is a leaf with a type, also the
   value of the leaf as the <em class="parameter"><code>v</code></em> parameter -
   otherwise <em class="parameter"><code>v</code></em> is NULL.</p><p>The <em class="parameter"><code>flags</code></em> parameter is a bitmask with
   the following bits:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">ITER_WANT_ATTR</span></dt><dd><p>If this flag is given and the node has any attributes
         set, the <em class="parameter"><code>attr_vals</code></em> parameter will point
         to a <em class="parameter"><code>num_attr_vals</code></em> long array of
         attributes and values (see
         <code class="function">maapi_get_attrs()</code>), otherwise
         <em class="parameter"><code>attr_vals</code></em> is NULL.</p></dd><dt><span class="term">ITER_WANT_LEAF_LIST_AS_LEAF</span></dt><dd><p>If this flag is given, leaf-lists will cause invocations
         of <code class="function">iter()</code> as for leafs and not as for
         lists, i.e. a single invocation with the
         <em class="parameter"><code>v</code></em> parameter giving the complete
         leaf-list, rather than an invocation for each leaf-list element
         with the value in the <em class="parameter"><code>kp</code></em>
         parameter.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>This flag is deprecated, and only present for
         temporary backward compatibility - it will be removed in a
         future release.</p></div></dd></dl></div><p>The return value from <code class="function">iter()</code> has the same
   effect as for <code class="function">maapi_diff_iterate()</code>, except that
   if ITER_SUSPEND is returned, the caller then has to call
   <code class="function">maapi_iterate_resume()</code> to continue/finish the
   iteration.</p><div class="funcsynopsis"><a name="fn.maapi_iterate_resume"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_iterate_resume</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret <var class="pdparam">reply</var>, </td></tr><tr><td>&nbsp;</td><td>enum maapi_iter_ret (*<var class="pdparam">iter</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>confd_attr_value_t *<var class="pdparam">attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">num_attr_vals</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">resumestate</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>The application <span class="emphasis"><em>must</em></span> call this function to
   finish up the iteration whenever an iterator function for
   <code class="function">maapi_iterate()</code> has returned ITER_SUSPEND. If
   the application does not wish to continue iteration, it must at least
   call <code class="code">maapi_iterate_resume(s, ITER_STOP, NULL, NULL);</code> to
   clean up the state. The <em class="parameter"><code>reply</code></em> parameter is
   what the iterator function would have returned (i.e. normally
   ITER_RECURSE or ITER_CONTINUE) if it hadn't returned
   ITER_SUSPEND. Note that it is up to the iterator function to somehow
   communicate that it has returned ITER_SUSPEND to the caller of
   <code class="function">maapi_iterate()</code>, this can for example be a field
   in a struct for which a pointer can be passed back and forth via the
   <em class="parameter"><code>state</code></em>/<em class="parameter"><code>resumestate</code></em>
   parameters.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS, CONFD_ERR_BADSTATE.</p><div class="funcsynopsis"><a name="fn.maapi_get_running_db_status"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_running_db_status</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If a transaction fails in the commit() phase, the
   configuration database is in in a possibly inconsistent state. This
   function queries ConfD on the consistency state. Returns 1 if the
   configuration is consistent and 0 otherwise.</p><div class="funcsynopsis"><a name="fn.maapi_set_running_db_status"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_running_db_status</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">status</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function explicitly sets ConfDs notion of the
   consistency state.</p><div class="funcsynopsis"><a name="fn.maapi_list_rollbacks"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_list_rollbacks</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>struct maapi_rollback *<var class="pdparam">rp</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">rp_size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>List at most <span class="type">*rp_size</span> number of rollback
   files. The number of existing rollback files is reported in
   *rp_size as well.  The function will populate an array of
   maapi_rollback structs.</p><div class="funcsynopsis"><a name="fn.maapi_load_rollback"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_rollback</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">rollback_num</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Install a rollback file.</p><div class="funcsynopsis"><a name="fn.maapi_request_action"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_request_action</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t *<var class="pdparam">params</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nparams</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nvalues</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">hashed_ns</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Invoke an action defined in the data model. The <em class="parameter"><code>params</code></em>
   and <em class="parameter"><code>values</code></em> arrays are the parameters for and
   results from the action, respectively, and use the Tagged Value Array
   format described in the <a class="link" href="rn02re15.html#man.3.confd_types.xml_structures" title="XML STRUCTURES">XML STRUCTURES</a>
   section of the <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a> manual
   page. The library allocates memory for the result values, and the
   caller is responsible for freeing it. This can in all cases be done
   with code like this:</p><div class="informalexample"><pre class="programlisting">confd_tag_value_t *values;
int nvalues = 0, i;

if (maapi_request_action(sock, params, nparams,
                         &amp;values, &amp;nvalues, myprefix__ns,
                         "/path/to/action") == CONFD_OK) {
    ...
    for (i = 0; i &lt; nvalues; i++)
        confd_free_value(CONFD_GET_TAG_VALUE(&amp;values[i]));
    if (nvalues &gt; 0)
        free(values);
}</pre></div><p>However if the value array is known not to include types that
   require memory allocation (see
   <code class="function">maapi_get_elem()</code> above), only the array itself
   needs to be freed.</p><p>The socket must have an established user session.  The path
   given by <em class="parameter"><code>fmt</code></em> and the varargs list is the full
   path to the action, i.e. the final element must be the name of the
   action in the data model.  Since actions
   are not associated with ConfD transactions, the namespace must be
   provided and the path must be absolute - but see
   <code class="function">maapi_request_action_th()</code> below.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_request_action_th"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_request_action_th</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t *<var class="pdparam">params</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nparams</var>, </td></tr><tr><td>&nbsp;</td><td>confd_tag_value_t **<var class="pdparam">values</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">nvalues</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Does the same thing as
   <code class="function">maapi_request_action()</code>, but uses the current
   namespace, the path position, and the user session
   from the transaction indicated by
   <em class="parameter"><code>thandle</code></em>, and makes the transaction handle
   available to the action() callback, see <a class="link" href="rn02re10.html" title="confd_lib_dp">confd_lib_dp(3)</a> (this is the only
   relation to the transaction, and the transaction is not affected in
   any way by the call itself). This function may be convenient in some
   cases where actions are invoked in conjunction with a transaction,
   and it must be used if the action needs to access the transaction
   store.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_request_action_str_th"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_request_action_str_th</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">output</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">cmd_fmt</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">path_fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Does the same thing as
   <code class="function">maapi_request_action_th()</code>, but takes the
   parameters as a string and returns the result as a string. The
   library allocates memory for the result string, and the caller is
   responsible for freeing it. This can in all cases be done with code
   like this:
</p><div class="informalexample"><pre class="programlisting">char *output = NULL;

if (maapi_request_action_str_th(sock, th, &amp;output,
    "test reverse listint [ 1 2 3 4 ]", "/path/to/action") == CONFD_OK) {
    ...
    free(output);
}</pre></div><p>The varargs in the end of the function must contain all values
  listed in both format strings (that is
  <em class="parameter"><code>cmd_fmt</code></em> and <em class="parameter"><code>path_fmt</code></em>)
  in the same order as they occur in the strings. Here follows an
  equivalent example which uses the format strings:
</p><div class="informalexample"><pre class="programlisting">char *output = NULL;

if (maapi_request_action_str_th(sock, th, &amp;output,
    "test %s [ 1 2 3 %d ]", "%s/action",
    "reverse listint", 4, "/path/to") == CONFD_OK) {
    ...
    free(output);
}</pre></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOSESSION, CONFD_ERR_BADPATH, CONFD_ERR_NOEXISTS,
   CONFD_ERR_BADTYPE, CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_xpath2kpath"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_xpath2kpath</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">xpath</var>, </td></tr><tr><td>&nbsp;</td><td>confd_hkeypath_t **<var class="pdparam">hkp</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Convert a XPath path to a hashed keypath. The XPath
   expression must be an "instance identifier", i.e. all elements and
   keys must be fully specified. Namespace prefixes are optional,
   unless required to resolve ambiguities (e.g. when multiple
   namespaces have the same root element).</p><p>The returned keypath is dynamically allocated, and may
   further contain dynamically allocated elements. The caller must
   free the allocated memory, easiest done by calling
   <code class="function">confd_free_hkeypath()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADPATH</p><div class="funcsynopsis"><a name="fn.maapi_user_message"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_user_message</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">to</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">message</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">sender</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Send a message to a specific user, a specific user session or
   all users depending on the <em class="parameter"><code>to</code></em> parameter. If
   set to a user name, then <em class="parameter"><code>message</code></em> will be
   delivered to all CLI and Web UI sessions by that user. If set to an
   integer string, eg "10", then <em class="parameter"><code>message</code></em> will be
   delivered to that specific user session, CLI or Web UI. If set to
   "all" then all users will get the
   <em class="parameter"><code>message</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_sys_message"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_sys_message</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">to</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Send a message to a specific user, a specific user session or
   all users depending on the <em class="parameter"><code>to</code></em> parameter. If
   set to a user name, then <em class="parameter"><code>message</code></em> will be
   delivered to all CLI and Web UI sessions by that user. If set to an
   integer string, eg "10", then <em class="parameter"><code>message</code></em> will be
   delivered to that specific user session, CLI or Web UI. If set to
   "all" then all users will get the <em class="parameter"><code>message</code></em>. No
   formatting of the message is performed as opposed to the user
   message where a timestamp and sender information is added to the
   message.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_prio_message"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_prio_message</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">to</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Send a high priority message to a specific user, a specific user session or
   all users depending on the <em class="parameter"><code>to</code></em> parameter. If
   set to a user name, then <em class="parameter"><code>message</code></em> will be
   delivered to all CLI and Web UI sessions by that user. If set to an
   integer string, eg "10", then <em class="parameter"><code>message</code></em> will be
   delivered to that specific user session, CLI or Web UI. If set to
   "all" then all users will get the <em class="parameter"><code>message</code></em>. No
   formatting of the message is performed as opposed to the user
   message where a timestamp and sender information is added to the
   message.</p><p>The message will not be delayed until the user terminates any
   ongoing command but will be output directly to the terminal without
   delay. Messages sent using the maapi_sys_message and maapi_user_message,
   on the other hand, are not displayed in the middle of some other output
   but delayed until the any ongoing commands have terminated.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_prompt"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Prompt user for a string. The <em class="parameter"><code>echo</code></em>
   parameter is used to control if the input should be echoed or
   not. If set to CONFD_ECHO all input will be visible and if set to
   CONFD_NOECHO only stars will be shown instead of the actual
   characters entered by the user.  The resulting string will be
   stored in <em class="parameter"><code>res</code></em> and it will be NUL
   terminated.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>:
   CONFD_ERR_MALLOC, CONFD_ERR_OS, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_prompt2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeout</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
   <code class="function">maapi_cli_prompt()</code>, but also takes a
   <em class="parameter"><code>timeout</code></em> parameter, which
   controls how long (in seconds) to wait for input before aborting.</p><p><span class="emphasis"><em>Errors</em></span>:
   CONFD_ERR_MALLOC, CONFD_ERR_OS, CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_prompt_oneof"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt_oneof</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">choice</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">count</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Prompt user for one of the strings given in the
   <em class="parameter"><code>choice</code></em> parameter.  For example:</p><div class="informalexample"><pre class="programlisting">int res;
char buf[BUFSIZ];
char *choice[] = {"yes","no"};

...

res = maapi_cli_prompt_oneof(sock, uinfo-&gt;usid,
                             "Do you want to proceed (yes/no): ",
                             choice, 2, buf, BUFSIZ);</pre></div><p>The user can enter a unique prefix of the choice but the
   value returned in buf will always be one of the strings provided in
   the <em class="parameter"><code>choice</code></em> parameter. The result string stored
   in buf is NUL terminated. If the user enters a value not in
   <em class="parameter"><code>choice</code></em> he will automatically be
   re-prompted. For example:</p><div class="informalexample"><pre class="screen">Do you want to proceed (yes/no): maybe
The value must be one of: yes,no.
Do you want to proceed (yes/no):</pre></div><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_prompt_oneof2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_prompt_oneof2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">prompt</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">choice</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">count</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeout</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
   <code class="function">maapi_cli_promt_oneof()</code>, but also takes a
   <em class="parameter"><code>timeout</code></em> parameter. If no activity is seen
   for <em class="parameter"><code>timeout</code></em> seconds an error is returned.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_read_eof"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_read_eof</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Read a multi line string from the CLI. The user has to end
   the input using ctrl-D. The entered characters will be stored NUL
   terminated in res. The <em class="parameter"><code>echo</code></em> parameters
   controls if the entered characters should be echoed or not. If set
   to CONFD_ECHO they will be visible and if set to CONFD_NOECHO stars
   will be echoed instead.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_read_eof2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_read_eof2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">echo</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeout</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function does the same as
   <code class="function">maapi_cli_read_eof()</code>, but also takes a
   <em class="parameter"><code>timeout</code></em> parameter, which
   indicates how long the user may be idle (in seconds) before the
   reading is aborted.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_write"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_write</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Write to the CLI.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_printf"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_printf</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Write to the CLI using printf formatting. This function is
   intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_vprintf"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_vprintf</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>va_list <var class="pdparam">args</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Does the same as <code class="function">maapi_cli_printf()</code>, but
   takes a single <span class="type">va_list</span> argument instead of a variable
   number of arguments, like <code class="function">vprintf()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_accounting"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_accounting</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">user</var>, </td></tr><tr><td>&nbsp;</td><td>const int <var class="pdparam">usid</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">cmdstr</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Generate an audit log entry in the CLI audit log.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_diff_cmd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_diff_cmd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle_old</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Get the diff between two sessions as C-/I-style CLI commands.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_path_cmd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_path_cmd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function tries to determine which C-/I-style CLI command
   can be associated with a given path in the data model in context
   of a given transaction. This is determined by running the formatting
   code used by the 'show running-config' command for the subtree given
   by the path, and the looking for text lines associated with the given
   path. Consequentcly, if the path does not exist in the transaction
   no output will be generated, or if tailf:cli- annotations have been
   used to suppress the 'show running-config' text for a path then no
   such command can be derived.</p><p>
     The <em class="parameter"><code>flags</code></em> can be given as
     <code class="constant">MAAPI_FLAG_EMIT_PARENTS</code> to enable the commands
     to reach the submode for the path to be emitted.
   </p><p>
     The <em class="parameter"><code>flags</code></em> can be given as
     <code class="constant">MAAPI_FLAG_DELETE</code> to emit the command
     to delete the given path.
   </p><p>
     The <em class="parameter"><code>flags</code></em> can be given as
     <code class="constant">MAAPI_FLAG_NON_RECURSIVE</code> to prevent that
     all children to a container or list item are displayed.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd_to_path"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_to_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">line</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">ns</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsize</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">path</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">psize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>
     Given a data model path formatted as a C- and I-style command, try
     to determine the corresponding namespace and path. If the string cannot be
     interpreted as a path an error message is given indicating that
     the string is either an operational mode command, a configuration
     mode command, or just badly formatted. The string is interpreted
     in the context of the current running configuration, ie all xpath
     expressions in the data model are evaluated in the context of the
     running config. Note that the same input may result in a correct
     answer when invoked with one state of the running config, and an
     error if the running config has another state due to different
     list elements being present, or xpath (when and display-when)
     expressions are being evaluated differently.
   </p><p>This function requires that the socket has an established user
   session.</p><p>
     The <em class="parameter"><code>line</code></em> is the NUL terminated string of command
     tokens to be interpreted.
   </p><p>
     The <em class="parameter"><code>ns</code></em> and <em class="parameter"><code>path</code></em>
     parameters are used for storing the resulting namespace and path.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd_to_path2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_to_path2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">line</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">ns</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsize</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">path</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">psize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>
     Given a data model path formatted as a C- and I-style command, try
     to determine the corresponding namespace and path. If the string cannot be
     interpreted as a path an error message is given indicating that
     the string is either an operational mode command, a configuration
     mode command, or just badly formatted. The string is interpreted
     in the context of the provided transaction handler, ie all xpath
     expressions in the data model are evaluated in the context of the
     transaction. Note that the same input may result in a correct
     answer when invoked with one state of one config, and an
     error when given another config due to different
     list elements being present, or xpath (when and display-when)
     expressions are being evaluated differently.
   </p><p>This function requires that the socket has an established user
   session.</p><p>
     The <em class="parameter"><code>th</code></em> is a transaction handler.
   </p><p>
     The <em class="parameter"><code>line</code></em> is the NUL terminated string of command
     tokens to be interpreted.
   </p><p>
     The <em class="parameter"><code>ns</code></em> and <em class="parameter"><code>path</code></em>
     parameters are used for storing the resulting namespace and path.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Execute CLI command in ongoing CLI session.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Execute CLI command in ongoing CLI session.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI. The flags field is used to
   disable certain checks during the execution. The value is a
   bitmask.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MAAPI_CMD_NO_FULLPATH</span></dt><dd><p>Do not perform the fullpath check on show
         commands.</p></dd><dt><span class="term">MAAPI_CMD_NO_HIDDEN</span></dt><dd><p>Allows execution of hidden CLI commands.</p></dd></dl></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd3"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd3</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Execute CLI command in ongoing CLI session.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI. The flags field is used to
   disable certain checks during the execution. The value is a
   bitmask.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MAAPI_CMD_NO_FULLPATH</span></dt><dd><p>Do not perform the fullpath check on show
         commands.</p></dd><dt><span class="term">MAAPI_CMD_NO_HIDDEN</span></dt><dd><p>Allows execution of hidden CLI commands.</p></dd></dl></div><p>The unhide parameter is used for passing a hide group which
   is unhidden during the execution of the command.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd4"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd4</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Execute CLI command in ongoing CLI session.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI. The flags field is used to
   disable certain checks during the execution. The value is a
   bitmask.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MAAPI_CMD_NO_FULLPATH</span></dt><dd><p>Do not perform the fullpath check on show
         commands.</p></dd><dt><span class="term">MAAPI_CMD_NO_HIDDEN</span></dt><dd><p>Allows execution of hidden CLI commands.</p></dd></dl></div><p>The unhide parameter is used for passing hide groups which
   are unhidden during the execution of the command.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd_io"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_io</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Execute CLI command in ongoing CLI session and output result on socket.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI. The flags field is used to
   disable certain checks during the execution. The value is a
   bitmask.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MAAPI_CMD_NO_FULLPATH</span></dt><dd><p>Do not perform the fullpath check on show
         commands.</p></dd><dt><span class="term">MAAPI_CMD_NO_HIDDEN</span></dt><dd><p>Allows execution of hidden CLI commands.</p></dd></dl></div><p>The unhide parameter is used for passing a hide group which
   is unhidden during the execution of the command.</p><p>The function returns <code class="constant">CONFD_ERR</code> on error
   or a positive integer id that can subsequently be used together
   with <code class="function">confd_stream_connect()</code>.  ConfD will write
   all data in a stream on that socket and
   when done, ConfD will close its end of the socket.</p><p>Once the stream socket is connected we can read the
   output from the cli command data on the socket. We need to
   continue reading until
   we receive EOF on the socket. To check if the command was
   successful we use the function.
   <code class="function">maapi_cli_cmd_io_result()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd_io2"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_io2</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">buf</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">unhide</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usize</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Execute CLI command in ongoing CLI session and output result on socket.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI. The flags field is used to
   disable certain checks during the execution. The value is a
   bitmask.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">MAAPI_CMD_NO_FULLPATH</span></dt><dd><p>Do not perform the fullpath check on show
         commands.</p></dd><dt><span class="term">MAAPI_CMD_NO_HIDDEN</span></dt><dd><p>Allows execution of hidden CLI commands.</p></dd></dl></div><p>The unhide parameter is used for passing hide groups which
   are unhidden during the execution of the command.</p><p>The function returns <code class="constant">CONFD_ERR</code> on error
   or a positive integer id that can subsequently be used together
   with <code class="function">confd_stream_connect()</code>.  ConfD will write
   all data in a stream on that socket and
   when done, ConfD will close its end of the socket.</p><p>Once the stream socket is connected we can read the
   output from the cli command data on the socket. We need to
   continue reading until
   we receive EOF on the socket. To check if the command was
   successful we use the function.
   <code class="function">maapi_cli_cmd_io_result()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_cmd_io_result"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_cmd_io_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We use this function to read the status of executing a cli
   command and streaming the result over a socket. The <em class="parameter"><code>sock</code></em>
   parameter must be the same maapi socket we used for
   <code class="function">maapi_cli_cmd_io()</code> and the
   <em class="parameter"><code>id</code></em> parameter is the <em class="parameter"><code>id</code></em>
   returned by <code class="function">maapi_cli_cmd_io()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_cli_get"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_get</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">opt</var>, </td></tr><tr><td>&nbsp;</td><td>char *<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">size</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Read CLI session parameter or attribute.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p>
     Possible params are
     <span class="phrase">
       for C and I-style: complete-on-space, idle-timeout,
       ignore-leading-space, paginate, output-file,
       screen-length, screen-width, history, terminal,
       autowizard, "service prompt config" , show-defaults,
       and if enabled, display-level. And for J-style:
     </span>
     complete-on-space, idle-timeout, ignore-leading-space,
     paginate, "output file", "screen length", "screen width",
     terminal, history, autowizard, "show defaults", and if
     enabled, display-level. In addition to this the attributes
     called annotation, tags and inactive can be read.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_cli_set"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_cli_set</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">usess</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">opt</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">value</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Set CLI session parameter.</p><p>This function is intended to be called from inside an action
   callback when invoked from the CLI.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_set_readonly_mode"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_set_readonly_mode</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flag</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>There are certain situations where we want to explicitly
   control if a ConfD instance should be able to handle write
   operations from the northbound agents. In certain high-availability
   scenarios we may want to ensure that a node is a true readonly
   node, i.e.  it should not be possible to initiate new write
   transactions on that node.</p><p>It can also be interesting in upgrade scenarios where we are
   interested in making sure that no configuration changes can occur
   during some interval.</p><p>This function toggles the readonly mode of a ConfD instance.
   If the <em class="parameter"><code>flag</code></em> parameter is non-zero, ConfD will
   be set in readonly mode, if it is zero, ConfD will be taken out of
   readonly mode.
   It is also worth to note that when a ConfD HA node is in slave mode as
   instructed by the application, no write transactions can occur
   regardless of the value of the flag set by this function.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_disconnect_remote"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_disconnect_remote</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">address</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Disconnect all remote connections between
   <code class="constant">CONFD_IPC_PORT</code> (see the <a class="link" href="ch28.html#ug.advanced.confd_ipc" title="28.6.&nbsp;ConfD IPC">ConfD IPC section in the
   Advanced Topics chapter in the User Guide</a>) and
   <em class="parameter"><code>address</code></em>.</p><p>Since ConfD clients, e.g. CDB readers/subscribers, are
   connected using TCP it is also possible to do this remotely over a
   network. However since TCP doesn't offer a fast and reliable way of
   detecting that the other end has disappeared ConfD can get stuck
   waiting for a reply from such a disconnected client.</p><p>In some environments there will be an alternative supervision
   method that can detect when a remote host is unavailable, and in
   that situation this function can be used to instruct ConfD to drop
   all remote connections to a particular host. The address parameter
   is an IP address as a string, and the socket is a maapi socket
   obtained using <code class="function">maapi_connect()</code>. On success,
   the function returns the number of connections that were
   closed.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>ConfD will close all its sockets with remote address
   <em class="parameter"><code>address</code></em>, <span class="emphasis"><em>except</em></span> HA
   connections. For HA use <code class="function">confd_ha_slave_dead()</code>
   or an HA state transition.</p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADTYPE, CONFD_ERR_UNAVAILABLE</p><div class="funcsynopsis"><a name="fn.maapi_disconnect_sockets"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_disconnect_sockets</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int *<var class="pdparam">sockets</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsocks</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function is an alternative to
   <code class="function">maapi_disconnect_remote()</code> that can be useful in
   particular when using the "External IPC" functionality (see "Using a
   different IPC mechanism" in the <a class="link" href="ch28.html#ug.advanced.confd_ipc" title="28.6.&nbsp;ConfD IPC">ConfD IPC section in the Advanced
   Topics chapter in the User Guide</a>). In this case ConfD does not
   have any knowledge of the remote address of the IPC connections, and
   thus <code class="function">maapi_disconnect_remote()</code> is not
   applicable. The <code class="function">maapi_disconnect_sockets()</code>
   instead takes an array of <em class="parameter"><code>nsocks</code></em> socket file
   descriptor numbers for the <em class="parameter"><code>sockets</code></em>
   parameter.</p><p>ConfD will close all connected sockets whose local file
   descriptor number is included the <em class="parameter"><code>sockets</code></em>
   array. The file descriptor numbers can be obtained e.g. via the
   <span class="command"><strong>lsof(8)</strong></span> command, or some similar tool in case
   <span class="command"><strong>lsof</strong></span> does not support the IPC mechanism that is
   being used.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADTYPE</p><div class="funcsynopsis"><a name="fn.maapi_save_config"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_save_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function can be used to save the entire config (or a
   subset thereof) in different formats. The
   <em class="parameter"><code>flags</code></em> parameter controls the saving as
   follows. The value is a bitmask.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">MAAPI_CONFIG_XML</code></span></dt><dd><p>The configuration format is XML.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_XML_PRETTY</code></span></dt><dd><p>The configuration format is pretty printed XML.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_JSON</code></span></dt><dd><p>The configuration is in JSON format.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_J</code></span></dt><dd><p>The configuration is in curly bracket Juniper CLI
         format.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_C</code></span></dt><dd><p>The configuration is in Cisco XR style format.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_C_IOS</code></span></dt><dd><p>The configuration is in Cisco IOS style format.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_XPATH</code></span></dt><dd><p>The <em class="parameter"><code>fmtpath</code></em> and remaining
         arguments give an XPath filter
         instead of a keypath. Can only be used with
         <code class="constant">MAAPI_CONFIG_XML</code> and
         <code class="constant">MAAPI_CONFIG_XML_PRETTY</code>.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_WITH_DEFAULTS</code></span></dt><dd><p>Default values are part of the configuration dump.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_SHOW_DEFAULTS</code></span></dt><dd><p>Default values are also shown next to the real
         configuration value. Applies only to the CLI formats.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_WITH_OPER</code></span></dt><dd><p>Include operational data in the dump.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_HIDE_ALL</code></span></dt><dd><p>Hide all hidden nodes (see below).</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_UNHIDE_ALL</code></span></dt><dd><p>Unhide all hidden nodes (see below).</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_WITH_SERVICE_META</code></span></dt><dd><p>Include NCS service-meta-data attributes (refcounter,
         backpointer, and original-value) in the dump.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_NO_PARENTS</code></span></dt><dd><p>When a path is provided its parent nodes are by default
         included. With this option the output will begin immediately
         at path - skipping any parents.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_OPER_ONLY</code></span></dt><dd><p>Include <span class="emphasis"><em>only</em></span> operational data, and
         ancestors to operational data nodes, in the dump.</p></dd></dl></div><p>The provided path indicates which part(s) of the configuration
   to save. By default it is interpreted as a keypath as for other MAAPI
   functions, and thus identifies the root of a subtree to save. However
   it is possible to indicate wildcarding of list keys by completely
   omitting key elements - i.e. this requests save of a subtree for each
   entry of the corresponding list. For
   <code class="constant">MAAPI_CONFIG_XML</code> and
   <code class="constant">MAAPI_CONFIG_XML_PRETTY</code> it is alternatively
   possible to give an XPath filter, by including the flag
   <code class="constant">MAAPI_CONFIG_XPATH</code>.</p><p>If for example <em class="parameter"><code>fmtpath</code></em> is
   <code class="sgmltag-element">"/aaa:aaa/authentication/users"</code> we dump a subtree of the
   AAA data, while if it is
   <code class="sgmltag-element">"/aaa:aaa/authentication/users/user/homedir"</code>, we dump only
   the <code class="sgmltag-element">homedir</code> leaf for each user in the AAA data.
   If <em class="parameter"><code>fmtpath</code></em> is NULL, the entire
   configuration is dumped, except that namespaces with restricted
   export (from <code class="code">tailf:export</code>) are treated as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>When the <code class="constant">MAAPI_CONFIG_XML</code> or
       <code class="constant">MAAPI_CONFIG_XML_PRETTY</code> formats are used,
       the context of the user session that started the transaction is
       used to select namespaces with restricted export. If the "system"
       context is used, all namespaces are selected, regardless of
       export restriction.</p></li><li class="listitem"><p>When one of the CLI formats is used, the context used to
       select namespaces with restricted export is always "cli".</p></li></ul></div><p>By default, the treatment of nodes with a
   <code class="code">tailf:hidden</code> statement
   depends on the state of the transaction. For a transaction
   started via MAAPI, no nodes are hidden, while for a transaction
   started by another northbound agent (e.g. CLI) and attached to, the
   nodes that are hidden are the same as in that agent session. The
   default can be overridden by using one of the flags
   <code class="constant">MAAPI_CONFIG_HIDE_ALL</code> and
   <code class="constant">MAAPI_CONFIG_UNHIDE_ALL</code>.</p><p>The function returns <code class="constant">CONFD_ERR</code> on error
   or a positive integer id that can subsequently be used together
   with <code class="function">confd_stream_connect()</code>.  Thus this
   function doesn't save the configuration to a file, but rather it
   returns an integer than is used together with a ConfD stream
   socket.  ConfD will write all data in a stream on that socket and
   when done, ConfD will close its end of the socket. Thus the
   following code snippet indicates the usage pattern of this
   function.</p><div class="informalexample"><pre class="programlisting">int id;
int streamsock;
struct sockaddr_in addr;

id = maapi_save_config(sock, th, flags, path);
if (id &lt; 0) {
    ... handle error ...
}

addr.sin_addr.s_addr = inet_addr("127.0.0.1");
addr.sin_family = AF_INET;
addr.sin_port = htons(CONFD_PORT);

streamsock = socket(PF_INET, SOCK_STREAM, 0);
confd_stream_connect(streamsock, (struct sockaddr*)&amp;addr,
                      sizeof(struct sockaddr_in), id, 0);</pre></div><p>Once the stream socket is connected we can read the
   configuration data on the socket. We need to continue reading until
   we receive EOF on the socket. To check if the configuration
   retrieval was successful we use the
   function <code class="function">maapi_save_config_result()</code>.</p><p>The stream socket must be connected within 10 seconds after
   the id is received.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BAD_TYPE</p><div class="funcsynopsis"><a name="fn.maapi_save_config_result"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_save_config_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We use this function to verify that we received the entire
   configuration over the stream socket. The <em class="parameter"><code>sock</code></em>
   parameter must be the same maapi socket we used for
   <code class="function">maapi_save_config()</code> and the
   <em class="parameter"><code>id</code></em> parameter is the <em class="parameter"><code>id</code></em>
   returned by <code class="function">maapi_save_config()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_load_config"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">filename</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function loads a configuration from
   <em class="parameter"><code>filename</code></em> into ConfD. The
   <em class="parameter"><code>th</code></em> parameter is a transaction handle. This
   can be either for a transaction created by the application, in
   which case the application must also apply the transaction, or for
   an attached transaction (which must not be applied by the
   application). The format of the file can be either XML, curly
   bracket Juniper CLI format, Cisco XR style format, or Cisco IOS style
   format. The caller of the function has to indicate which it is by
   using one of the
   <code class="constant">MAAPI_CONFIG_XML</code>,
   <code class="constant">MAAPI_CONFIG_J</code>,
   <code class="constant">MAAPI_CONFIG_C</code>, or
   <code class="constant">MAAPI_CONFIG_C_IOS</code> flags, with the same meanings
   as for <code class="function">maapi_save_config()</code>. If the name of the file
   ends in .gz (or .Z) then the file is assumed to be gzipped, and
   will be uncompressed as it is loaded.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you use a relative pathname for
   <em class="parameter"><code>filename</code></em>, it is taken as relative to the
   working directory of the ConfD daemon, i.e. the directory where the
   daemon was started.</p></div><p>By default the complete configuration (as allowed by the user
   of the current transaction) is deleted before the file is
   loaded. To merge the contents of the file use the
   <code class="constant">MAAPI_CONFIG_MERGE</code> flag. To replace only the
   part of the configuration that is present in the file, use the
   <code class="constant">MAAPI_CONFIG_REPLACE</code> flag.</p><p>
     If the transaction <em class="parameter"><code>th</code></em> is started against
     the data store <code class="constant">CONFD_OPERATIONAL</code> config
     false data is loaded. The existing config false data is not
     deleted before the file is loaded. Rather it is the
     responsibility of the client.
   </p><p>
     The only supported format for loading 'config false' data is
     <code class="constant">MAAPI_CONFIG_XML</code>.
   </p><p>Additional flags for
   <code class="constant">MAAPI_CONFIG_XML</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">MAAPI_CONFIG_WITH_OPER</code></span></dt><dd><p>Any operational data in the file should be ignored
         (instead of producing an error).</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_XML_LOAD_LAX</code></span></dt><dd><p>Lax loading. Ignore unknown namespaces, elements, and
         attributes.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_OPER_ONLY</code></span></dt><dd><p>Load <span class="emphasis"><em>only</em></span> operational data, and
         ancestors to operational data nodes.</p></dd></dl></div><p>Additional flag for
   <code class="constant">MAAPI_CONFIG_C</code> and
   <code class="constant">MAAPI_CONFIG_C_IOS</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">MAAPI_CONFIG_AUTOCOMMIT</code></span></dt><dd><p>A commit should be performed after each line.  In this
         case the transaction identified by <em class="parameter"><code>th</code></em> is
         not used for the loading.</p></dd></dl></div><p>Additional flags for all CLI formats, i.e.
   <code class="constant">MAAPI_CONFIG_J</code>,
   <code class="constant">MAAPI_CONFIG_C</code>, and
   <code class="constant">MAAPI_CONFIG_C_IOS</code>:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="constant">MAAPI_CONFIG_CONTINUE_ON_ERROR</code></span></dt><dd><p>Do not abort the load when an error is
         encountered.</p></dd><dt><span class="term"><code class="constant">MAAPI_CONFIG_SUPPRESS_ERRORS</code></span></dt><dd><p>Do not display the long error message but instead a
         oneline error with the line number.</p></dd></dl></div><p>The other
   <em class="parameter"><code>flags</code></em> parameters are the same as for
   <code class="function">maapi_save_config()</code>, however the flags
   <code class="constant">MAAPI_CONFIG_WITH_SERVICE_META</code>
   <code class="constant">MAAPI_CONFIG_NO_PARENTS</code> are ignored.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADTYPE, CONFD_ERR_BADPATH, CONFD_ERR_BAD_CONFIG,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_PROTOUSAGE, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_load_config_cmds"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config_cmds</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">cmds</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function loads a configuration like
   <code class="function">maapi_load_config()</code>, but reads the configuration
   from the string <em class="parameter"><code>cmds</code></em> instead of from a
   file. The <em class="parameter"><code>th</code></em> and <em class="parameter"><code>flags</code></em>
   parameters are the same as for
   <code class="function">maapi_load_config()</code>.</p><p>
     An optional <em class="parameter"><code>chroot</code></em> path can be given. This
     is only used with the <code class="constant">MAAPI_CONFIG_C</code> flag
     set.
   </p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADTYPE, CONFD_ERR_BADPATH, CONFD_ERR_BAD_CONFIG,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_PROTOUSAGE, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_load_config_stream"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config_stream</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function loads a configuration like
   <code class="function">maapi_load_config()</code>, but reads the configuration
   from a ConfD stream socket instead of from a file. The
   <em class="parameter"><code>th</code></em> and <em class="parameter"><code>flags</code></em> parameters
   are the same as for <code class="function">maapi_load_config()</code>.</p><p>The function returns <code class="constant">CONFD_ERR</code> on error
   or a positive integer id that can subsequently be used together
   with <code class="function">confd_stream_connect()</code>. ConfD will read all
   data from the stream socket until it receives EOF.
   Thus the following code snippet indicates the usage pattern of this
   function.</p><div class="informalexample"><pre class="programlisting">int id;
int streamsock;
struct sockaddr_in addr;

id = maapi_load_config_stream(sock, th, flags);
if (id &lt; 0) {
    ... handle error ...
}

addr.sin_addr.s_addr = inet_addr("127.0.0.1");
addr.sin_family = AF_INET;
addr.sin_port = htons(CONFD_PORT);

streamsock = socket(PF_INET, SOCK_STREAM, 0);
confd_stream_connect(streamsock, (struct sockaddr*)&amp;addr,
                      sizeof(struct sockaddr_in), id, 0);</pre></div><p>Once the stream socket is connected we can write the
   configuration data on the socket. When we have written the complete
   configuration, we must close the socket, to make ConfD receive EOF.
   To check if the configuration load was successful we use the
   function <code class="function">maapi_load_config_stream_result()</code>.</p><p>The stream socket must be connected within 10 seconds after
   the id is received.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADTYPE, CONFD_ERR_PROTOUSAGE, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_load_config_stream_result"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_load_config_stream_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We use this function to verify that the configuration we wrote
   on the stream socket was successfully loaded. The
   <em class="parameter"><code>sock</code></em> parameter must be the same maapi socket
   we used for <code class="function">maapi_load_config_stream()</code> and the
   <em class="parameter"><code>id</code></em> parameter is the <em class="parameter"><code>id</code></em>
   returned by <code class="function">maapi_load_config_stream()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADTYPE, CONFD_ERR_BADPATH, CONFD_ERR_BAD_CONFIG,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_roll_config"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_roll_config</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function can be used to save the equivalent of a rollback
   file for a given configuration before it is committed (or a
   subtree thereof) in curly bracket format. </p><p>The provided path indicates where we want the configuration
   to be rooted. It must be a prefix prepended keypath. If
   <em class="parameter"><code>fmtpath</code></em> is NULL, a rollback config for the entire
   configuration is dumped. If
   for example <em class="parameter"><code>fmtpath</code></em> is
   <code class="sgmltag-element">"/aaa:aaa/authentication/users"</code> we create a
   rollback config for a
   part of the AAA data.  It is not possible to extract non-config
   data using this function.</p><p>The function returns <code class="constant">CONFD_ERR</code> on error
   or a positive integer id that can subsequently be used together
   with <code class="function">confd_stream_connect()</code>.  Thus this
   function doesn't save the rollback configuration to a file, but rather it
   returns an integer that is used together with a ConfD stream
   socket.  ConfD will write all data in a stream on that socket and
   when done, ConfD will close its end of the socket. Thus the
   following code snippet indicates the usage pattern of this
   function.</p><div class="informalexample"><pre class="programlisting">int id;
int streamsock;
struct sockaddr_in addr;

id = maapi_roll_config(sock, tid, path);
addr.sin_addr.s_addr = inet_addr("127.0.0.1");
addr.sin_family = AF_INET;
addr.sin_port = htons(CONFD_PORT);

streamsock = socket(PF_INET, SOCK_STREAM, 0);
confd_stream_connect(streamsock, (struct sockaddr*)&amp;addr,
                      sizeof (struct sockaddr_in), id,0);</pre></div><p>Once the stream socket is connected we can read the
   configuration data on the socket. We need to continue reading until
   we receive EOF on the socket. To check if the configuration
   retrieval was successful we use the
   function <code class="function">maapi_roll_config_result()</code>.</p><p>The stream socket must be connected within 10 seconds after
   the id is received.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BAD_TYPE</p><div class="funcsynopsis"><a name="fn.maapi_roll_config_result"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_roll_config_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>We use this function to assert that we received the entire
   rollback configuration over a stream socket. The <em class="parameter"><code>sock</code></em>
   parameter must be the same maapi socket we used for
   <code class="function">maapi_roll_config()</code> and the
   <em class="parameter"><code>id</code></em> parameter is the <em class="parameter"><code>id</code></em>
   returned by <code class="function">maapi_roll_config()</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_ACCESS_DENIED, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_get_stream_progress"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_get_stream_progress</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">id</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>In some cases (e.g. an action or custom command that can be
   interrupted by the user) it may be useful to be able to terminate
   ConfD's reading of data from a stream socket (by closing the socket)
   without waiting for a potentially large amount of data written to the
   socket to be consumed by ConfD. This function allows us to limit the
   amount of data "in flight" between the application and ConfD, by
   reporting the amount of data read by ConfD so far.</p><p>The <em class="parameter"><code>sock</code></em> parameter must be the maapi
   socket used for a function call that required a stream socket for
   writing to ConfD (currently the only such function is
   <code class="function">maapi_load_config_stream()</code>), and the
   <em class="parameter"><code>id</code></em> parameter is the <em class="parameter"><code>id</code></em>
   returned by that function.
   <code class="function">maapi_get_stream_progress()</code> returns the number
   of bytes that ConfD has read from the stream socket. If
   <em class="parameter"><code>id</code></em> does not identify a stream socket that is
   currently being read by ConfD, the function returns CONFD_ERR with
   <code class="varname">confd_errno</code> set to CONFD_ERR_NOEXISTS. This can be
   due to e.g. that the socket has been closed, or that an error has
   occurred - but also that ConfD has determined that all the data has
   been read (e.g. the end of an XML document has been read). To avoid
   the latter case, the function should only be called when we have more
   data to write, and before the writing of that data. The following
   code shows a possible way to use this function.</p><div class="informalexample"><pre class="programlisting">#define MAX_IN_FLIGHT 4096

char buf[BUFSIZ];
int sock, streamsock, id;
int n, n_written = 0, n_read = 0;
int result;
...

while (!do_abort() &amp;&amp; (n = get_data(buf, sizeof(buf))) &gt; 0) {
    while (n_written - n_read &gt; MAX_IN_FLIGHT) {
        if ((n_read = maapi_get_stream_progress(sock, id)) &lt; 0) {
            ... handle error ...
        }
    }
    if (write(streamsock, buf, n) != n) {
        ... handle error ...
    }
    n_written += n;
}
close(streamsock);
result = maapi_load_config_stream_result(sock, id);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>A call to
   <code class="function">maapi_get_stream_progress()</code> does not return
   until the number of bytes read has increased from the previous call
   (or if there is an error). This means that the above code does not
   imply busy-looping, but also that if the code was to call
   <code class="function">maapi_get_stream_progress()</code> when
   <code class="varname">n_read</code> == <code class="varname">n_written</code>, the result
   would be a deadlock.</p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_NOEXISTS</p><div class="funcsynopsis"><a name="fn.maapi_xpath_eval"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_xpath_eval</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>int (*<var class="pdparam">result</var>)(confd_hkeypath_t *<var class="pdparam">kp</var>, </td></tr><tr><td>&nbsp;</td><td>confd_value_t *<var class="pdparam">v</var>, </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">state</var>), </td></tr><tr><td>&nbsp;</td><td>void (*<var class="pdparam">trace</var>)(char *), </td></tr><tr><td>&nbsp;</td><td>void *<var class="pdparam">initstate</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This function evaluates the XPath Path expression as supplied
   in <em class="parameter"><code>expr</code></em>. For each node in the resulting node
   set the function <em class="parameter"><code>result</code></em> is called with the
   keypath to the resulting node as the first argument, and, if the
   node is a leaf and has a value, the value of that node as the
   second argument. The expression will be evaluated using the root
   node as the context node, unless a path to an existing node is
   given as the last argument. For each invocation the
   <code class="function">result()</code> function should return
   <code class="constant">ITER_CONTINUE</code> to tell the XPath evaluator to
   continue with the next resulting node. To stop the evaluation the
   <code class="function">result()</code> can return
   <code class="constant">ITER_STOP</code> instead.</p><p>The <em class="parameter"><code>trace</code></em> is a pointer to a function
   that takes a single string as argument. If supplied it will be
   invoked when the xpath implementation has trace output for the
   current expression. (For an easy start, for example the
   <code class="function">puts(3)</code> will print the trace output to
   stdout). If no trace is wanted <code class="constant">NULL</code> can be
   given.</p><p>The <em class="parameter"><code>initstate</code></em> parameter can be used
   for any user supplied opaque data (i.e. whatever is supplied as
   <em class="parameter"><code>initstate</code></em> is passed as
   <em class="parameter"><code>state</code></em> to the <code class="function">result()</code>
   function for each invocation).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADPATH, CONFD_ERR_XPATH</p><div class="funcsynopsis"><a name="fn.maapi_xpath_eval_expr"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_xpath_eval_expr</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>char **<var class="pdparam">res</var>, </td></tr><tr><td>&nbsp;</td><td>void (*<var class="pdparam">trace</var>)(char *), </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Evaluate the XPath expression given in
   <em class="parameter"><code>expr</code></em> and return the result as a string,
   pointed to by <em class="parameter"><code>res</code></em>. If the call succeeds,
   <em class="parameter"><code>res</code></em> will point to a malloc:ed string that
   the caller needs to free. If the call fails
   <em class="parameter"><code>res</code></em> will be set to
   <code class="constant">NULL</code>.</p><p>It is possible to supply a path which will be treated as the
   initial context node when evaluating <em class="parameter"><code>expr</code></em>
   (i.e. if the path is relative, this is treated as the starting
   point, and this is also the node that
   <code class="function">current()</code> will return when used in the XPath
   expression). If NULL is given, the current maapi position is
   used.</p><p>The <em class="parameter"><code>trace</code></em> is a pointer to a function
   that takes a single string as argument. If supplied it will be
   invoked when the xpath implementation has trace output for the
   current expression. (For an easy start, for example the
   <code class="function">puts(3)</code> will print the trace output to
   stdout). If no trace is wanted <code class="constant">NULL</code> can be
   given.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADPATH, CONFD_ERR_XPATH</p><div class="funcsynopsis"><a name="fn.maapi_query_start"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_start</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">expr</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">context_node</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">chunk_size</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">initial_offset</var>, </td></tr><tr><td>&nbsp;</td><td>enum confd_query_result_type <var class="pdparam">result_as</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nselect</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">select[]</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">nsort</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">sort[]</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Start a new query attached to the transaction given in
   <em class="parameter"><code>th</code></em>. If successful a query handle is returned
   (the query handle is then used in subsequent calls to
   <code class="function">maapi_query_result()</code> etc). Brief summary of
   all parameters:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>sock</code></em></span></dt><dd><p>A previously opened maapi socket.</p></dd><dt><span class="term"><em class="parameter"><code>th</code></em></span></dt><dd><p>A transaction handle to a previously started transaction.</p></dd><dt><span class="term"><em class="parameter"><code>expr</code></em></span></dt><dd><p>The primary XPath expression.</p></dd><dt><span class="term"><em class="parameter"><code>context_node</code></em></span></dt><dd><p>The context node (an ikeypath) for the primary
           expression. <code class="code">NULL</code> is legal, and means that the
           context node will be <code class="code">/</code>.</p></dd><dt><span class="term"><em class="parameter"><code>chunk_size</code></em></span></dt><dd><p>How many results to return at a time. If set to 0 a
         default number will be used.</p></dd><dt><span class="term"><em class="parameter"><code>initial_offset</code></em></span></dt><dd><p>Which result in line to begin with (1 means to start
         from the begining).</p></dd><dt><span class="term"><em class="parameter"><code>result_as</code></em></span></dt><dd><p>The format the results will be returned in.</p></dd><dt><span class="term"><em class="parameter"><code>nselect</code></em></span></dt><dd><p>The number of expressions in the
         <em class="parameter"><code>select</code></em> parameter.</p></dd><dt><span class="term"><em class="parameter"><code>select</code></em></span></dt><dd><p>An array of XPath "select" expressions, of length
         <em class="parameter"><code>nselect</code></em>.</p></dd><dt><span class="term"><em class="parameter"><code>nsort</code></em></span></dt><dd><p>The number of expressions in the
         <em class="parameter"><code>sort</code></em> parameter.</p></dd><dt><span class="term"><em class="parameter"><code>sort</code></em></span></dt><dd><p>An array of XPath expressions which will be used for
         sorting, of length <em class="parameter"><code>nselect</code></em>.</p></dd></dl></div><p>A query is a way of evaluating an XPath expression and
   returning the results in chunks. The usage pattern is as follows: a
   primary expression in provided in the <em class="parameter"><code>expr</code></em>
   argument, which must evaluate to a node-set, the "results". For each
   node in the results node-set every "select" expression is evaluated
   with the result node as its context node. For example, given the
   YANG snippet:</p><div class="informalexample"><pre class="programlisting">
  list interface {
    key name;
    unique number;
    leaf name {
      type string;
    }
    leaf number {
      type uint32;
      mandatory true;
    }
    leaf enabled {
      type boolean;
      default true;
    }
  ...
  }
</pre></div><p>and given that we want to find the name and number of all
   enabled interfaces - the <em class="parameter"><code>expr</code></em> could be
   <code class="code">"/interface[enabled='true']"</code>, and the select
   expressions would be <code class="code">{ "name", "number" }</code>. Note that
   the select expressions can have any valid XPath expression, so if
   you wanted to find out an interfaces name, and whether its number
   is even or not, the expressions would be: <code class="code">{ "name", "(number
   mod 2) == 0" }</code>.</p><p>The results are then fetched using the
   <code class="function">maapi_query_result()</code> function, which returns
   the results on the format specified by the
   <em class="parameter"><code>result_as</code></em> parameter. There are four
   different types of result, as defined by the type <span class="type">enum
   confd_query_result_type</span>:</p><div class="informalexample"><a name="enum.confd_query_result_type"></a><pre class="programlisting"><strong class="hl-keyword">enum</strong> confd_query_result_type {
    CONFD_QUERY_STRING = <span class="hl-number">0</span>,
    CONFD_QUERY_HKEYPATH = <span class="hl-number">1</span>,
    CONFD_QUERY_HKEYPATH_VALUE = <span class="hl-number">2</span>,
    CONFD_QUERY_TAG_VALUE = <span class="hl-number">3</span>
};</pre></div><p>I.e. the results can be returned as strings, hkeypaths,
   hkeypaths and values, or tags and values. The string is just the
   resulting string of evaluating the select XPath expression. For
   hkeypaths, tags, and values it is the path/tag/value of the
   <span class="emphasis"><em>node that the select XPath expression evaluates
   to</em></span>. This means that care must be taken so that the
   combination of select expression and return types actually yield
   sensible results (for example "1 + 2" is a valid select XPath
   expression, and would result in the string "3" when setting the
   result type to <code class="constant">CONFD_QUERY_STRING</code> - but it is
   not a node, and thus have no hkeypath, tag, or value). A complete
   example:</p><div class="informalexample"><pre class="programlisting">
  qh = maapi_query_start(s, th, "/interface[enabled='true']", NULL,
                         1000, 1, CONFD_QUERY_TAG_VALUE,
                         2, (char *[]){ "name", "number" }, 0, NULL);
  n = 0;
  do {
    maapi_query_result(s, qh, &amp;qr);
    n = qr-&gt;nresults;
    for (i=0; i&lt;n; i++) {
      printf("result %d:\n", i + qr-&gt;offset);
      for (j=0; j&lt;qr-&gt;nelements; j++) {
        // We know the type is tag-value
        char *tag = confd_hash2str(qr-&gt;results[i].tv[j].tag.tag);
        confd_pp_value(tmpbuf, BUFSIZ, &amp;qr-&gt;results[i].tv[j].v);
        printf("  %s: %s\n", tag, tmpbuf);
      }
    }
    maapi_query_free_result(qr);
  } while (n &gt; 0);
  maapi_query_stop(s, qh);
     </pre></div><p>It is possible to sort the results using the built-in XPath
   function <code class="function">sort-by()</code> (see the <a class="link" href="rn03re20.html" title="tailf_yang_extensions">tailf_yang_extensions(5)</a>
   man page)</p><p>It is also possible to sort the result using any expressions
   passed in the <em class="parameter"><code>sort</code></em> array. These array will
   be used to construct a temporary index which will live as long as
   the query is active. For example to start a query sorting first on
   the enabled leaf, and then on number one would call:</p><div class="informalexample"><pre class="programlisting">
qh = maapi_query_start(s, th, "/interface[enabled='true']", NULL,
                       1000, 1, CONFD_QUERY_TAG_VALUE,
                       3, (char *[]){ "name", "number", "enabled" },
                       2, (char *[]){ "enabled", "number" });
...
     </pre></div><p>Note that the index the query constructs is kept in memory,
   which will be released when the query is stopped.</p><div class="funcsynopsis"><a name="fn.maapi_query_result"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_result</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var>, </td></tr><tr><td>&nbsp;</td><td>struct confd_query_result **<var class="pdparam">qrs</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Fetch the next available chunk of results associated with
   query handle <em class="parameter"><code>qh</code></em>. The results are returned in
   a <span class="type">struct confd_query_result</span>, which is allocated by the
   library. The structure is defined as:</p><div class="informalexample"><a name="struct.confd_query_result"></a><pre class="programlisting"><strong class="hl-keyword">struct</strong> confd_query_result {
    <strong class="hl-keyword">enum</strong> confd_query_result_type type;
    <strong class="hl-keyword">int</strong> offset;
    <strong class="hl-keyword">int</strong> nresults;
    <strong class="hl-keyword">int</strong> nelements;
    <strong class="hl-keyword">union</strong> {
        <strong class="hl-keyword">char</strong> **str;
        confd_hkeypath_t *hkp;
        <strong class="hl-keyword">struct</strong> {
            confd_hkeypath_t hkp;
            confd_value_t    val;
        } *kv;
        confd_tag_value_t *tv;
    } *results;
    <strong class="hl-keyword">void</strong> *__internal;           <em class="hl-comment" style="color: silver">/* confd_lib internal housekeeping */</em>
};</pre></div><p>The <em class="parameter"><code>type</code></em> will always be the same as
   was requested in the call to
   <code class="function">maapi_query_start()</code>, it is there to indicate
   which of the pointers in the union to use. The
   <em class="parameter"><code>offset</code></em> is the number of the first result in
   this chunk (i.e. for the first chunk it will be 1). How many
   results that are in this chunk is indicated in
   <em class="parameter"><code>nresults</code></em>, when there are no more available
   results it will be set to 0. Each result consists of
   <em class="parameter"><code>nelements</code></em> elements (this number is the same
   as the number of select parameters given in the call to
   <code class="function">maapi_query_start()</code>.</p><p>All data pointed to in the result struct (as well as the
   struct itself) is allocated by the library - and when finished
   processing the result the user must call
   <code class="function">maapi_query_free_result()</code> to free this
   data.</p><div class="funcsynopsis"><a name="fn.maapi_query_free_result"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_free_result</b>(</code></td><td>struct confd_query_result *<var class="pdparam">qrs</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>The <span class="type">struct confd_query_result</span> returned by
   <code class="function">maapi_query_result()</code> is dynamically allocated
   (and it also contains pointers to other dynamically allocated data)
   and so it needs to be freed when the result has been processed. Use
   this function to free the <span class="type">struct confd_query_result</span>
   (and its accompanying data) returned by
   <code class="function">maapi_query_result()</code>.</p><div class="funcsynopsis"><a name="fn.maapi_query_reset"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_reset</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Reset / rewind a running query so that it starts from the
   beginning again. Next call to
   <code class="function">maapi_query_result()</code> will then return the
   first chunk of results. The function can be called at any time
   (i.e. both after all results have been returned to essentially run
   the same query again, as well as after fetching just one or a
   couple of results).</p><div class="funcsynopsis"><a name="fn.maapi_query_reset_to"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_reset_to</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">offset</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Like <code class="function">maapi_query_reset()</code>, except after
   the query has been reset it is restarted with the initial offset
   set to <em class="parameter"><code>offset</code></em>. Next call to
   <code class="function">maapi_query_result()</code> will then return the
   first chunk of results at that offset. The function can be called
   at any time (i.e. both after all results have been returned to
   essentially run the same query again, as well as after fetching
   just one or a couple of results).</p><div class="funcsynopsis"><a name="fn.maapi_query_stop"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_query_stop</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">qh</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Stops the running query identified by
   <em class="parameter"><code>qh</code></em>, and makes ConfD free up any internal
   resources associated with the query. If a query isn't explicitly
   closed using this call it will be cleaned up when the transaction
   the query is linked to ends.</p><div class="funcsynopsis"><a name="fn.maapi_install_crypto_keys"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_install_crypto_keys</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>It is possible to define DES3 and AES keys inside
   confd.conf. These keys are used by ConfD to encrypt data which is
   entered into the system which has either of the two builtin types
   <span class="type">tailf:des3-cbc-encrypted-string</span> or
   <span class="type">tailf:aes-cfb-128-encrypted-string</span>. See <a class="link" href="rn02re15.html" title="confd_types">confd_types(3)</a>.</p><p>This function will copy those keys from ConfD (which reads
   confd.conf) into memory in the library. To decrypt data of these
   types, use the function <code class="function">confd_decrypt()</code>, see
   <a class="link" href="rn02re13.html" title="confd_lib_lib">confd_lib_lib(3)</a>.</p><div class="funcsynopsis"><a name="fn.maapi_do_display"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_do_display</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">thandle</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmtpath</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>If the data model uses the
   YANG <code class="code">when</code> or <code class="code">tailf:display-when</code>
   statement, this function can be used to determine if the
   item given by <em class="parameter"><code>fmtpath, ...</code></em> should be displayed
   or not.</p><div class="funcsynopsis"><a name="fn.maapi_init_upgrade"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_init_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">timeoutsecs</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">flags</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>This is the first of three functions that must be called in
   sequence to perform an in-service data model upgrade, i.e. replace
   fxs files etc without restarting the ConfD daemon. See the <a class="link" href="ch13.html" title="Chapter&nbsp;13.&nbsp;In-service Data Model Upgrade">In-service Data Model Upgrade chapter in the
   User Guide</a> for a detailed description of this
   procedure.</p><p>This function initializes the upgrade procedure. The
   <em class="parameter"><code>timeoutsecs</code></em> parameter specifies a maximum time
   to wait for users to voluntarily exit from "configure mode" sessions
   in CLI and Web UI. If transactions are still active when the timeout
   expires, the function will by default fail with CONFD_ERR_TIMEOUT. If
   the flag MAAPI_UPGRADE_KILL_ON_TIMEOUT was given via the
   <em class="parameter"><code>flags</code></em> parameter, such transactions will instead
   be forcibly terminated, allowing the initialization to complete
   successfully.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_LOCKED, CONFD_ERR_BADSTATE, CONFD_ERR_HA_WITH_UPGRADE,
   CONFD_ERR_TIMEOUT, CONFD_ERR_ABORTED</p><div class="funcsynopsis"><a name="fn.maapi_perform_upgrade"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_perform_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char **<var class="pdparam">loadpathdirs</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">n</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>When <code class="function">maapi_init_upgrade()</code> has completed
   successfully, this function must be called to instruct ConfD to load
   the new data model files. The <em class="parameter"><code>loadpathdirs</code></em>
   parameter is an array of <em class="parameter"><code>n</code></em> strings that specify
   the directories to load from, corresponding to the
   <code class="sgmltag-element">/confdConfig/loadPath/dir</code> elements in
   <code class="filename">confd.conf</code> (see <a class="link" href="rn03re17.html" title="confd.conf">confd.conf(5)</a>).</p><p>These directories will also be searched for CDB "init files"
   (see the <a class="link" href="ch05.html#ug.cdb.init" title="5.8.&nbsp;Loading initial data into CDB">CDB chapter in the User
   Guide</a>). I.e. if the upgrade needs such files, we can place
   them in one of the new load path directories - or we can include
   directories that are used <span class="emphasis"><em>only</em></span> for CDB "init
   files" in the <em class="parameter"><code>loadpathdirs</code></em> array,
   corresponding to the <code class="sgmltag-element">/confdConfig/cdb/initPath/dir</code>
   elements that can be specified in
   <code class="filename">confd.conf</code>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADSTATE, CONFD_ERR_BAD_CONFIG</p><div class="funcsynopsis"><a name="fn.maapi_commit_upgrade"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_commit_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>When also <code class="function">maapi_perform_upgrade()</code> has
   completed successfully, this function must be called to make the
   upgrade permanent. This includes committing the CDB upgrade
   transaction when CDB is used, and we can thus get all the different
   validation errors that can otherwise result from
   <code class="function">maapi_apply_trans()</code>.</p><p>When <code class="function">maapi_commit_upgrade()</code> has completed
   successfully, the program driving the upgrade must also make sure
   that the <code class="sgmltag-element">/confdConfig/loadPath/dir</code> elements in
   <code class="filename">confd.conf</code> reference the new directories.
   If CDB "init files" are used in the upgrade as described for
   <code class="function">maapi_commit_upgrade()</code> above, the program should
   also make sure that the <code class="sgmltag-element">/confdConfig/cdb/initPath/dir</code>
   elements reference the directories where those files are
   located.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
   CONFD_ERR_BADSTATE, CONFD_ERR_NOTSET,
   CONFD_ERR_NON_UNIQUE, CONFD_ERR_BAD_KEYREF,
   CONFD_ERR_TOO_FEW_ELEMS, CONFD_ERR_TOO_MANY_ELEMS,
   CONFD_ERR_UNSET_CHOICE, CONFD_ERR_MUST_FAILED,
   CONFD_ERR_MISSING_INSTANCE, CONFD_ERR_INVALID_INSTANCE,
   CONFD_ERR_BADTYPE, CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_abort_upgrade"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_abort_upgrade</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Calling this function at any point before the call of
   <code class="function">maapi_commit_upgrade()</code> will abort the upgrade.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><code class="function">maapi_abort_upgrade()</code> should
   <span class="emphasis"><em>not</em></span> be called if any of the three previous
   functions fail - in that case, ConfD will do an internal abort of the
   upgrade.</p></div></div><div class="refsect1"><a name="man.3.confd_lib_maapi.daemon_control"></a><h2>CONFD DAEMON CONTROL</h2><div class="funcsynopsis"><a name="fn.maapi_aaa_reload"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_aaa_reload</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>When the ConfD AAA tree is populated by an external data
    provider (see the <a class="link" href="ch14.html#ug.aaa.authentication" title="14.4.&nbsp;Authentication">AAA
    chapter in the User Guide</a>), this function can be used by the
    data provider to notify ConfD when there is a change to the AAA data.
    I.e. it is an alternative to executing the command <span class="command"><strong>confd
    --clear-aaa-cache</strong></span>.</p><p>If the <em class="parameter"><code>synchronous</code></em> parameter is 0, the
    function will only initiate the loading of the AAA data, just like
    <span class="command"><strong>confd --clear-aaa-cache</strong></span> does, and return CONFD_OK
    as long as the communication with ConfD succeeded. Otherwise it will
    wait for the loading to complete, and return CONFD_OK only if the
    loading was successful.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_aaa_reload_path"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_aaa_reload_path</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>A variant of <code class="function">maapi_aaa_reload()</code> that
    causes only the AAA subtree given by the path in
    <em class="parameter"><code>fmt</code></em> to be loaded. This may be useful to load
    changes to the AAA data when loading the complete AAA tree from an
    external data provider takes a long time. Obviously care must be
    taken to make sure that all changes actually get loaded, and a
    complete load using e.g. <code class="function">maapi_aaa_reload()</code>
    should be done at least when ConfD is started. The path may specify
    a container or list entry, but not a specific leaf.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_snmpa_reload"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_snmpa_reload</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>When the ConfD SNMP Agent config is implemented by an external
    data provider (see the <a class="link" href="ch17.html#ug.snmpa.csload" title="17.2.8.&nbsp;Loading YANG modules for built-in MIBs">
    SNMP Agent chapter in the User Guide</a>), this function must be
    used by the data provider to notify ConfD when there is a change to
    the data.</p><p>If the <em class="parameter"><code>synchronous</code></em> parameter is 0, the
    function will only initiate the loading of the data, and return
    CONFD_OK as long as the communication with ConfD succeeded.
    Otherwise it will wait for the loading to complete, and return
    CONFD_OK only if the loading was successful.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_EXTERNAL</p><div class="funcsynopsis"><a name="fn.maapi_start_phase"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_start_phase</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">phase</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Once the ConfD daemon has been started in phase0 it is
    possible to use this function to tell the daemon to proceed to
    startphase 1 or 2 (as indicated in the
    <em class="parameter"><code>phase</code></em> parameter). If
    <em class="parameter"><code>synchronous</code></em> is non-zero the call does not
    return until the daemon has completed the transition to the
    requested start phase.</p><p>Note that start-phase1 can fail, (see documentation of
    <code class="option">--start-phase1</code> in <a class="link" href="rn01re01.html" title="confd">confd(1)</a>) in particular if CDB
    fails. In that case <code class="function">maapi_start_phase()</code> will
    return CONFD_ERR, with confderrno set to
    CONFD_ERR_START_FAILED. However if ConfD stops before it has a
    chance to send back the error CONFD_EOF might be returned.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_START_FAILED</p><div class="funcsynopsis"><a name="fn.maapi_wait_start"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_wait_start</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">phase</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>To synchronize startup with ConfD this function can be used
    to wait for ConfD to reach a particular start phase (0, 1, or
    2). Note that to implement an equivalent of <a class="link" href="rn01re01.html" title="confd"><span class="command"><strong>confd
    --wait-started</strong></span></a> or <a class="link" href="rn01re01.html" title="confd"><span class="command"><strong>confd
    --wait-phase0</strong></span></a> case must also be taken to retry
    <code class="function">maapi_connect()</code>, which
    will fail until ConfD has started enough to accept connections to
    its IPC port.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_PROTOUSAGE</p><div class="funcsynopsis"><a name="fn.maapi_stop"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_stop</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">synchronous</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Request the ConfD daemon to stop, if
    <em class="parameter"><code>synchronous</code></em> is non-zero the call will wait
    until ConfD has come to a complete halt. Note that since the
    daemon exits, the socket won't be re-usable after this
    call. Equivalent to <a class="link" href="rn01re01.html" title="confd"><span class="command"><strong>confd
    --stop</strong></span></a>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_reload_config"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_reload_config</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Request that the ConfD daemon reloads its configuration
    files. The daemon will also close and re-open its
    log files. Equivalent to <a class="link" href="rn01re01.html" title="confd"><span class="command"><strong>confd
    --reload</strong></span></a>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_reopen_logs"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_reopen_logs</b>(</code></td><td>int <var class="pdparam">sock</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Request that the ConfD daemon closes and re-opens its
    log files, useful for logrotate(8).</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS</p><div class="funcsynopsis"><a name="fn.maapi_rebind_listener"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_rebind_listener</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>int <var class="pdparam">listener</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Request that the subsystem(s) specified by
    <em class="parameter"><code>listener</code></em> rebinds its listener socket(s).
    Currently open sockets (if any) will be closed, and new sockets
    created and bound via <code class="function">bind(2)</code> and
    <code class="function">listen(2)</code>. This is useful e.g. if
    <code class="sgmltag-element">/confdConfig/ignoreBindErrors/enabled</code> is set to "true" in
    <code class="filename">confd.conf</code>, and some bindings have failed due
    to a problem that subsequently has been fixed. Calling this function
    then avoids the disable/enable config change that would otherwise be
    required to cause a rebind.</p><p>The following values can be used for the
    <em class="parameter"><code>listener</code></em> parameter, ORed together if more
    than one:</p><div class="informalexample"><pre class="programlisting">#define CONFD_LISTENER_IPC     (1 &lt;&lt; 0)
#define CONFD_LISTENER_NETCONF (1 &lt;&lt; 1)
#define CONFD_LISTENER_SNMP    (1 &lt;&lt; 2)
#define CONFD_LISTENER_CLI     (1 &lt;&lt; 3)
#define CONFD_LISTENER_WEBUI   (1 &lt;&lt; 4)
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>It is not possible to rebind sockets for northbound
    listeners during the transition from start phase 1 to start phase 2.
    If this is attempted, the call will fail (and do nothing) with
    <code class="varname">confd_errno</code> set to CONFD_ERR_BADSTATE.</p></div><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_BADSTATE</p><div class="funcsynopsis"><a name="fn.maapi_clear_opcache"></a><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">maapi_clear_opcache</b>(</code></td><td>int <var class="pdparam">sock</var>, </td></tr><tr><td>&nbsp;</td><td>const char *<var class="pdparam">fmt</var>, </td></tr><tr><td>&nbsp;</td><td>...<code>)</code>;</td></tr></table><div class="funcprototype-spacer">&nbsp;</div></div><p>Request clearing of the operational data cache (see the <a class="link" href="ch06.html#ug.opdata.caching" title="6.10.&nbsp;Caching Operational Data">Operational Data</a> chapter in
    the User Guide). A path can be given via the
    <em class="parameter"><code>fmt</code></em> and subsequent parameters, to clear only
    the cached data for the subtree designated by that path. To clear
    the whole cache, pass NULL or "/" for
    <em class="parameter"><code>fmt</code></em>.</p><p><span class="emphasis"><em>Errors</em></span>: CONFD_ERR_MALLOC, CONFD_ERR_OS,
    CONFD_ERR_BADPATH</p></div><div class="refsect1"><a name="man.3.confd_lib_maapi.see_also"></a><h2>SEE ALSO</h2><p><span class="citerefentry"><span class="refentrytitle">confd_lib</span>(3)</span> - Confd lib</p><p><span class="citerefentry"><span class="refentrytitle">confd_types</span>(3)</span> - ConfD C data types</p><p>The ConfD User Guide</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="rn02re13.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="rn02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="rn02re15.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">confd_lib_lib&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;confd_types</td></tr></table></div></body></html>